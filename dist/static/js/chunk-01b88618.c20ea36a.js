(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-01b88618"],{"0d5e":function(e,t,a){"use strict";a.d(t,"b",function(){return s}),a.d(t,"c",function(){return r}),a.d(t,"d",function(){return n}),a.d(t,"a",function(){return c});var o=a("b775");function s(e,t){return Object(o["a"])({url:e,method:"get",params:t})}function r(e,t){return Object(o["a"])({url:e,method:"post",data:t})}function n(e,t){return Object(o["a"])({url:e,method:"put",data:t})}function c(e,t){return Object(o["a"])({url:e,method:"delete",data:t})}},"1ad2":function(e,t,a){"use strict";var o=a("ed5b"),s=a.n(o);s.a},"78ed":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"account-container"},[a("el-form",{ref:"accountForm",staticClass:"account-form",attrs:{model:e.accountForm,rules:e.accountRules,autocomplete:"off","hide-required-asterisk":"","label-width":"80px"}},[a("el-form-item",{attrs:{label:"姓名",prop:"name"}},[a("el-input",{attrs:{placeholder:"姓名"},model:{value:e.accountForm.name,callback:function(t){e.$set(e.accountForm,"name",t)},expression:"accountForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[a("el-input",{attrs:{name:"mobile",maxlength:"11",clearable:"",placeholder:"手机号"},model:{value:e.accountForm.mobile,callback:function(t){e.$set(e.accountForm,"mobile",e._n(t))},expression:"accountForm.mobile"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"职位",prop:"post"}},[a("el-input",{attrs:{name:"post",clearable:"",placeholder:"职位",autocomplete:"off"},model:{value:e.accountForm.post,callback:function(t){e.$set(e.accountForm,"post",t)},expression:"accountForm.post"}}),e._v(" "),a("el-input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{clearable:"",placeholder:"职位"}})],1),e._v(" "),1!=e.userInfo.type?a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{type:"password",placeholder:"密码"}}),e._v(" "),a("el-input",{ref:"password",attrs:{type:"password",name:"password",clearable:"",placeholder:"密码",autocomplete:"off","auto-complete":"new-password"},model:{value:e.accountForm.password,callback:function(t){e.$set(e.accountForm,"password",t)},expression:"accountForm.password"}})],1):e._e(),e._v(" "),a("div",{staticClass:"account-btn",style:{"padding-top":1!=e.userInfo.type?"0":"50px"}},[a("el-button",{staticClass:"el-button-default",attrs:{round:"",size:"mini"},on:{click:e.cancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{loading:e.loading,round:"",size:"mini",type:"primary"},on:{click:e.submit}},[e._v("保存")])],1)],1),e._v(" "),a("div",{staticClass:"photo"},[a("el-upload",{ref:"upload",staticClass:"avatar-uploader",attrs:{action:"",drag:"","on-change":e.onchange,"show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload,"auto-upload":!1,"http-request":e.upLoadAvatar}},[e.imageUrl?a("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过2MB")])])],1)],1)},s=[],r=(a("7f7f"),a("0d5e")),n=a("c24f"),c=a("61f7"),u={name:"Account",props:{userInfo:{type:Object,default:null}},data:function(){var e=function(e,t,a){""===t?a(new Error("请输入新手机号码")):Object(c["e"])(t)?a():a(new Error("手机号输入不正确!"))};return{loading:!1,userId:0,showCropper:!1,imageUrl:"",imageUpdate:!1,imgData:{accept:"image/jpeg, image/png, image/jpg"},accountForm:{name:"",mobile:"",post:"",password:""},accountRules:{name:[{required:!0,trigger:"blur",message:"请输入姓名"}],mobile:[{required:!0,trigger:"blur",validator:e}],post:[{required:!0,trigger:"blur",message:"请输入职位"}],password:[{required:!0,trigger:"blur",message:"请输入密码"},{min:6,message:"密码必须大于6位",trigger:"blur"}]}}},created:function(){var e=this;1===e.userInfo.type?(e.userId=e.userInfo.userId,e.accountForm.name=e.userInfo.cusName,e.accountForm.mobile=e.userInfo.phone,e.accountForm.post=e.userInfo.postName,e.accountForm.password="111111",e.imageUrl="http://192.168.1.32:8081/user/img/"+e.userInfo.cusPic+"?t="+(new Date).getTime()):(e.accountForm.name="",e.accountForm.mobile="",e.accountForm.post="",e.accountForm.password="",e.imageUrl="")},methods:{getObjectURL:function(e){var t=null;return void 0!==window.createObjectURL?t=window.createObjectURL(e):void 0!==window.URL?t=window.URL.createObjectURL(e):void 0!==window.webkitURL&&(t=window.webkitURL.createObjectURL(e)),t},onchange:function(e,t){var a=e.raw;if(a){var o=a.type,s=a.size;if(-1===this.imgData.accept.indexOf(o)||""===o)return this.$message({message:"请选择jpg、jpeg、png格式图片文件",type:"warning"}),!1;if(s>2097152)return this.$message({message:"请选择2M以下图片文件",type:"warning"}),!1;this.imageUpdate=!0,this.imageUrl=this.getObjectURL(a)}},upLoadAvatar:function(e){var t=this,a=new FormData;a.append("file",e.file),Object(n["g"])(this.userId,a).then(function(e){t.loading=!1,t.$emit("submituser")})},submit:function(){var e=this,t=this;this.$refs.accountForm.validate(function(a){if(a){var o={cpid:t.userInfo.cpid,cusName:t.accountForm.name,phone:t.accountForm.mobile,deptId:t.userInfo.deptId,postName:t.accountForm.post,cusPassword:t.accountForm.password};t.loading=!0,0===t.userInfo.type?Object(r["c"])("/user",o).then(function(a){0===a.status?(e.userId=a.data.userId,e.$message({message:"添加成功",type:"success",duration:3e3}),""!==e.imageUrl?t.$refs.upload.submit():(t.loading=!1,t.$emit("submituser"))):(e.$message({message:a.msg,type:"warning",duration:3e3}),t.loading=!1,t.$emit("submituser"))}):(o.userId=t.userInfo.userId,o.cusName=o.cusName===t.userInfo.cusName?null:o.cusName,o.phone=o.phone===t.userInfo.phone?null:o.phone,o.postName=o.postName===t.userInfo.postName?null:o.postName,o.cusPassword=null,Object(r["d"])("/user",o).then(function(a){0===a.status?(e.$message({message:"修改成功",type:"success",duration:3e3}),""!==e.imageUrl&&e.imageUpdate?t.$refs.upload.submit():(t.loading=!1,t.$emit("submituser"))):(e.$message({message:a.msg,type:"warning",duration:3e3}),t.loading=!1,t.$emit("submituser"))}))}})},cancel:function(){this.$emit("canceluser")},handleAvatarSuccess:function(e,t){this.imageUrl=URL.createObjectURL(t.raw)},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type,a=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG 格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&a}}},i=u,l=(a("1ad2"),a("adf4"),a("2877")),m=Object(l["a"])(i,o,s,!1,null,"d908b5a6",null);t["default"]=m.exports},"7c2f":function(e,t,a){},adf4:function(e,t,a){"use strict";var o=a("7c2f"),s=a.n(o);s.a},ed5b:function(e,t,a){}}]);