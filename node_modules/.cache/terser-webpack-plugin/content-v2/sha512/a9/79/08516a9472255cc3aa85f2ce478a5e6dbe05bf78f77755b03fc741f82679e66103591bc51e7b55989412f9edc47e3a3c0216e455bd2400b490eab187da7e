{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-dd0fea90\"],{\"0bfa\":function(t,a,e){},\"0d5e\":function(t,a,e){\"use strict\";e.d(a,\"b\",function(){return n}),e.d(a,\"c\",function(){return l}),e.d(a,\"d\",function(){return s}),e.d(a,\"a\",function(){return o});var i=e(\"b775\");function n(t,a){return Object(i[\"a\"])({url:t,method:\"get\",params:a})}function l(t,a){return Object(i[\"a\"])({url:t,method:\"post\",data:a})}function s(t,a){return Object(i[\"a\"])({url:t,method:\"put\",data:a})}function o(t,a){return Object(i[\"a\"])({url:t,method:\"delete\",data:a})}},b2d9:function(t,a,e){\"use strict\";var i=e(\"0bfa\"),n=e.n(i);n.a},d921:function(t,a,e){\"use strict\";e.r(a);var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e(\"div\",{staticClass:\"routeinstall\"},[e(\"el-scrollbar\",{staticClass:\"scroll_box\",attrs:{tag:\"ul\"}},[e(\"div\",{staticClass:\"leftdiv\"},[e(\"div\",{staticClass:\"leftdiv_list title_name\"},[t._v(\"场所标记\")]),t._v(\" \"),e(\"div\",{staticClass:\"leftdiv_list\"},[e(\"div\",{staticClass:\"star\"},[t._v(\"*\")]),t._v(\"\\n        点位类型\\n        \"),e(\"el-select\",{staticClass:\"elselect\",staticStyle:{float:\"right\"},attrs:{placeholder:\"请选择\"},on:{change:function(a){return t.qing()}},model:{value:t.value1,callback:function(a){t.value1=a},expression:\"value1\"}},t._l(t.option,function(t,a){return e(\"el-option\",{key:a,attrs:{label:t.typeName,value:JSON.stringify(t)}})}),1)],1),t._v(\" \"),e(\"div\",{staticClass:\"leftdiv_list\"},[e(\"div\",{staticClass:\"star\"},[t._v(\"*\")]),t._v(\"\\n        点位名称\\n        \"),e(\"el-input\",{attrs:{placeholder:\"请输入内容\",disabled:t.new_built},model:{value:t.value2,callback:function(a){t.value2=a},expression:\"value2\"}})],1),t._v(\" \"),e(\"div\",{staticClass:\"leftdiv_list\"},[t._v(\"\\n        点位备注\\n        \"),e(\"el-input\",{attrs:{placeholder:\"请输入内容\",disabled:t.new_built},model:{value:t.value3,callback:function(a){t.value3=a},expression:\"value3\"}})],1),t._v(\" \"),e(\"div\",{staticClass:\"leftdiv_list instructions\"},[t._v(\"\\n        点位说明\\n        \"),e(\"el-input\",{staticClass:\"textarea\",attrs:{type:\"textarea\",maxlength:\"100\",rows:2,placeholder:\"请输入内容\",resize:\"none\",disabled:t.new_built},model:{value:t.value4,callback:function(a){t.value4=a},expression:\"value4\"}})],1),t._v(\" \"),e(\"div\",{staticClass:\"leftdiv_list\"},[e(\"div\",{staticClass:\"star\"},[t._v(\"*\")]),t._v(\"\\n        绑定景点\\n        \"),e(\"el-select\",{staticClass:\"elselect\",staticStyle:{float:\"right\"},attrs:{placeholder:\"请选择\",disabled:t.new_built},model:{value:t.value5,callback:function(a){t.value5=a},expression:\"value5\"}},t._l(t.attractions,function(t,a){return e(\"el-option\",{key:a,attrs:{label:t.pointName,value:JSON.stringify(t)}})}),1)],1),t._v(\" \"),e(\"div\",{staticClass:\"leftdiv_list location title_name\",staticStyle:{\"padding-left\":\"20px\"}},[t._v(\"\\n        位置信息\\n        \"),e(\"div\",{staticClass:\"blue_bar\"})]),t._v(\" \"),e(\"div\",{staticClass:\"leftdiv_list\"},[e(\"div\",{staticClass:\"star\"},[t._v(\"*\")]),t._v(\"经度\"),e(\"el-input\",{attrs:{placeholder:\"请输入内容\",disabled:t.new_built},model:{value:t.value6,callback:function(a){t.value6=a},expression:\"value6\"}})],1),t._v(\" \"),e(\"div\",{staticClass:\"leftdiv_list\"},[e(\"div\",{staticClass:\"star\"},[t._v(\"*\")]),t._v(\"纬度\"),e(\"el-input\",{attrs:{placeholder:\"请输入内容\",disabled:t.new_built},model:{value:t.value7,callback:function(a){t.value7=a},expression:\"value7\"}})],1),t._v(\" \"),e(\"div\",{staticClass:\"leftdiv_list btn_box\"},[t.new_built?e(\"el-button\",{staticStyle:{float:\"left\",\"margin-left\":\"15%\"},attrs:{type:t.new_built?\"primary\":\"\",size:\"mini\",round:\"\"},on:{click:function(a){return t.new_building()}}},[t._v(\"新建\")]):t._e(),t._v(\" \"),t.new_built?t._e():e(\"el-button\",{staticStyle:{float:\"left\",\"margin-left\":\"15%\"},attrs:{type:\"primary\",size:\"mini\",round:\"\"},on:{click:function(a){t.new_built=!t.new_built}}},[t._v(\"取消\")]),t._v(\" \"),e(\"el-button\",{staticStyle:{float:\"right\",\"margin-right\":\"15%\"},attrs:{type:t.new_built?\"\":\"primary\",disabled:t.new_built,size:\"mini\",round:\"\"},on:{click:function(a){return t.ti()}}},[t._v(\"保存\")])],1)])]),t._v(\" \"),e(\"el-amap\",{staticClass:\"map map_box\",attrs:{vid:\"amap-vue\",zoom:t.zoom,center:t.center,events:t.events,\"map-style\":t.mapStyle1,\"amap-manager\":t.amapManager}},[t._l(t.markers,function(t,a){return e(\"el-amap-marker\",{key:a,attrs:{position:t.position,events:t.events,icon:t.icon,\"ext-data\":t,\"top-when-click\":\"true\",draggable:t.draggable,\"raise-on-drag\":t.raiseOnDrag}})}),t._v(\" \"),t.window?e(\"el-amap-info-window\",{attrs:{position:t.window.position,visible:t.window.visible,offset:t.window.offset}},[e(\"div\",[\"a\"!==t.markerid?e(\"el-button\",{attrs:{type:\"primary\",plain:\"\"},on:{click:t.edit_btn}},[t._v(\"编辑\")]):t._e(),t._v(\" \"),\"a\"!==t.markerid?e(\"el-button\",{attrs:{type:\"primary\",plain:\"\"},on:{click:t.delete_btn}},[t._v(\"删除\")]):t._e(),t._v(\" \"),\"a\"===t.markerid?e(\"el-button\",{attrs:{type:\"primary\",plain:\"\"},on:{click:t.delete_btn}},[t._v(\"取消\")]):t._e()],1)]):t._e()],2)],1)},n=[],l=(e(\"7f7f\"),e(\"ac6a\"),e(\"8f9b\")),s=e.n(l),o=e(\"0d5e\"),r=new s.a.AMapManager,d={name:\"Map\",data:function(){var t=this;return{zoom:16,center:[116.336496,39.942178],mapStyle1:\"amap://styles/whitesmoke\",activeName:\"qing\",tape:1,amapManager:r,value1:\"\",value2:\"\",value3:\"\",value4:\"\",value5:\"\",value6:\"\",value7:\"\",new_built:!0,new_marker:!1,new_marker_id:\"\",new_marker_save:!1,old_id:\"\",old_icon:\"\",olc_click:0,maps:null,data_all:null,markerid:\"\",events:{click:function(a){if(!1===t.new_built&&t.new_marker){t.disabled=!1;var i={};t.new_marker=!1,i={position:[a.lnglat.lng,a.lnglat.lat],icon:e(\"dbbd\"),draggable:!1,extData:{id:\"a\",pointName:t.value2}},t.value6=a.lnglat.lng,t.value7=a.lnglat.lat,t.new_marker_id=\"a\",t.markerid=\"a\",t.markers.push(i),t.ups_load(t.markers)}else\"a\"!==t.markerid?t.$message({message:\"请先点击新建按钮\",type:\"warning\"}):(t.value6=a.lnglat.lng,t.value7=a.lnglat.lat,t.markers[t.markers.length-1].position=[a.lnglat.lng,a.lnglat.lat])}},overlayGroups:[],data:[],markers:[],windows:[],window:\"\",slotStyle:{padding:\"2px 8px\",color:\"#333\"},click_num:\"\",option:[],datas:[],attractions:[{value:\"1\",label:\"景点1\"},{value:\"2\",label:\"景点2\"},{value:\"3\",label:\"景点3\"}]}},computed:{open:function(){return this.value1&&this.value2&&this.value5&&this.value6&&this.value7}},watch:{data:function(){},new_built:function(){this.markerid=\"\",this.value2=\"\",this.value3=\"\",this.value4=\"\",this.value5=\"\",this.value6=\"\",this.qing()}},created:function(){window.handler=this.handler},mounted:function(){this.ups_load(this.datas),this.updata()},methods:{qing:function(){var t=this,a=this,e={cpid:this.$store.state.user.companyId,typeid:JSON.parse(this.value1).id};Object(o[\"b\"])(\"/mngpoint/getPointInfoByTypeId\",e).then(function(e){for(var i=[],n=0;n<e.data.length;n++){for(var l,s=0;s<a.option.length;s++)console.log(a.option[s].id,e.data[0].pointTypeId),a.option[s].id===e.data[0].pointTypeId&&(l=a.option[s].icon);i.push({icon:l,position:[e.data[n].mngPointLon,e.data[n].mngPointLat],id:e.data[n].id,pointName:e.data[n].pointName,remarks:e.data[n].remarks,pointType:\"场所\",mngPointLon:e.data[n].mngPointLon,mngPointLat:e.data[n].mngPointLat,label:e.data[n].placeName,name:e.data[n].pointName,path:[e.data[n].mngPointLon,e.data[n].mngPointLat],draggable:!1,extData:{id:e.data[n].id,pointName:e.data[n].pointName,remarks:e.data[n].remarks,pointType:\"景点\",mngPointLon:e.data[n].mngPointLon,mngPointLat:e.data[n].mngPointLat,label:e.data[n].placeName,name:e.data[n].pointName,path:[e.data[n].mngPointLon,e.data[n].mngPointLat]}})}t.data_all=i,t.ups_load(i)})},updata:function(){var t=this,a=this;Object(o[\"b\"])(\"/mngpoint/getpointtypeByProperties\",{cpid:this.$store.state.user.companyId,properties:2}).then(function(e){if(0===e.data.length)Object(o[\"b\"])(\"mngpoint/initpointtype\",{cpid:t.$store.state.user.companyId}).then(function(a){t.updata()});else{a.option=e.data;for(var i=0;i<a.option.length;i++)a.option[i].icon=\"http://192.168.1.32:8081/mngpoint/img/icon/\"+a.option[i].url+\"?t=\"+(new Date).getTime();a.value1=JSON.stringify(e.data[0]),t.qing()}}),Object(o[\"b\"])(\"/mngpoint/getPointInfoByTypeId\",{cpid:this.$store.state.user.companyId,typeid:1}).then(function(t){a.attractions=t.data})},change:function(t){var a=this,e=parseInt(t)-1,i={};a.option.forEach(function(t,a){e===a&&(i.label=t.label,i.value=e)})},ups_load:function(t){for(var a=[],i=[],n=this,l=function(l){o={position:t[l].position,icon:t[l].icon,draggable:!1,extData:t[l].extData,events:{click:function(t){\"a\"!==n.markerid&&!0===n.new_built?(n.markerid=t.target.Uh.extData.extData.id,n.windows.forEach(function(t){t.visible=!1}),n.window=n.windows[l],n.$nextTick(function(){n.window.visible=!0,n.window.position=n.markers[l].position}),n.value6=this.getPosition().lng,n.value7=this.getPosition().lat,n.value2=this.Uh.extData.extData.name,n.value3=this.Uh.extData.extData.pointName,n.value4=this.Uh.extData.extData.remarks,n.markers.forEach(function(t,a){console.log(t),t.extData.id===n.markerid?t.icon=e(\"dbbd\"):t.extData.id!==n.new_marker_id||n.new_marker_save?t.icon=JSON.parse(n.value1).icon:t.icon=\"\"})):(console.log(t),\"a\"===this.Uh.extData.extData.id&&(n.windows.forEach(function(t){t.visible=!1}),n.window=n.windows[l],n.$nextTick(function(){n.window.visible=!0,n.window.position=n.markers[l].position})))},dragstart:function(){n.window.visible=!1},dragging:function(){var t=this;n.value6=this.getPosition().lng,n.value7=this.getPosition().lat,n.markers.forEach(function(a,e){a.extData.id===n.markerid&&(a.position=[t.getPosition().lng,t.getPosition().lat])})}}},a.push(o),i.push({position:t[l].position,visible:!1,offset:[10,-20],closeWhenClickMap:!0})},s=0;s<t.length;s++){var o;l(s)}this.markers=a,this.data_all=a,this.windows=i},edit_btn:function(){var t=this;this.new_built=!1,this.click_map=2,this.markers.forEach(function(a){t.markerid===a.extData.id&&(a.draggable=!0,t.window={position:a.position,visible:!1,offset:[10,-20],closeWhenClickMap:!0})}),this.windows.forEach(function(t){t.visible=!1})},delete_btn:function(){var t=this,a=this;a.$confirm(\"a\"!==a.markerid?\"此操作将永久删除该文件, 是否继续?\":\"请确认是否取消\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then(function(e){a.window.visible=!1,a.click_map=0,console.log(a.data_all),\"a\"!==a.markerid?Object(o[\"b\"])(\"/mngpoint/delPointInfo\",{id:a.markerid}).then(function(a){console.log(a),\"SUCCESS\"===a.msg?t.qing():t.$message({message:a.msg,type:\"warning\"})}):t.qing(),a.markerid=\"\",a.value2=\"\",a.value3=\"\",a.value4=\"\",a.value5=\"\",a.value6=\"\",a.new_built=!0})},ti:function(){var t=this;if(\"\"!==this.value2&&\"\"!==this.value5&&\"\"!==this.value6&&\"\"!==this.value7){this.new_built=!0,this.click_num&&(this.windows[this.click_num].visible=!1);var a={cpid:this.$store.state.user.companyId,pointTypeId:JSON.parse(this.value1).id,pointProperties:2,pointName:this.value2,remarks:this.value3,pointDescription:this.value4,scenicSpotId:JSON.parse(this.value5).id,scenicSpotName:JSON.parse(this.value5).pointName,pointType:JSON.parse(this.value1).typeName,mngPointLon:this.value6,mngPointLat:this.value7};\"a\"!==this.markerid&&(a.id=this.markerid),Object(o[\"c\"])(\"/mngpoint/savePointInfo\",a).then(function(a){console.log(\"保存后\"),console.log(a),t.qing(),t.markerid=\"\",t.value2=\"\",t.value3=\"\",t.value4=\"\",t.value5=\"\",t.value6=\"\",t.value7=\"\",t.$message({message:\"保存成功\",type:\"success\"})})}else this.$message({message:\"请认真检查填写项\",type:\"warning\"})},new_building:function(){var t=this;this.click_map=0,this.new_built=!1,this.new_marker=!0,this.window=!1,this.markers.forEach(function(a){t.old_icon&&a.extData.id===t.old_id&&(a.icon=t.old_icon)}),this.value2=\"\",this.value3=\"\",this.value4=\"\",this.value5=\"\",this.value6=\"\"},addfun:function(){var t=this;this.events={init:function(a){a.on(\"click\",function(a){t.wei(a.lnglat.getLng(),a.lnglat.getLat(),t)})}}},addmarker:function(){var t=this,a=r.getMap(),e=[],i=new AMap.Marker({position:[t.value6,t.value7],text:\"123\"});e.push(i),this.overlayGroups=new AMap.OverlayGroup(e),a.add(t.overlayGroups)},wei:function(t,a,e){this.data[this.data.length-1]=[t,a],e.value6=t,e.value7=a,this.addmarker()},handleClick:function(t,a){console.log(t,a)}}},u=d,c=(e(\"b2d9\"),e(\"2877\")),v=Object(c[\"a\"])(u,i,n,!1,null,\"94040fdc\",null);a[\"default\"]=v.exports},dbbd:function(t,a){t.exports=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACEAAAAtCAMAAAAX+PImAAAAkFBMVEUAAAAzdfYzdfYydvYydfYzdfYzdfYydfYydfYydfYzdvYydfYydfYydfYydfYydfYydfYydfUydvYzdfYydfYydfYydfYydfYydfYydfYydfYydfYydfUzdvYydfY0dfYzdfYydfYydfYydfUzdfY0dfYzdfYzdfYzdfY0dfYzdvYzdvYydfYydfU0dfYzdfaK7HXJAAAAL3RSTlMANv369MOFEAPm39EcvrWlmYpqSTsTDAfu49vOr04/MSsj18ifkX15cmFfJxhiQxlK8i8AAAE+SURBVDjLfdTXcoNADAXQC5hmigvuhWLHdlwS/f/fJZRBYmeX84bmetlBkiFYXhLaZIeJZ0EjeF6IHZYBFFZEQ4ccA0uHVPYDgkc6cw58k56Hzq9NBmc0NnsyCX3U7mS2aI7YjSQmGwA/snDLiuw2EZUngJQfjzFq8ZFLJyDgX4QftD5hX9sBFeeX/Im5GCPnh3WfWHPRwpmvCcavzkXCAeNGrmDJAzuyWMpXzvrEjGdgCxw48kLrxaUIwFy2wQfgL5QBWJHguCfXkYUC/yIyS1DLRhIrNE7GwBda/tQQuGzQqfRDtK/QK3WnTN8Q/JRU7lpZW0+95Baqh2nfmPzYaQCNwOVL+tAq++3MoMVtTmHy5m6YJO1iQY//SO4wK3iiDbZOO7wjpnVLMSZqxnuMWzcVY2a8WAbxla4xBv4AC3+K3wqmyF0AAAAASUVORK5CYII=\"}}]);","extractedComments":[]}