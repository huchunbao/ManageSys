{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-81e1ff44\"],{\"0d5e\":function(t,i,a){\"use strict\";a.d(i,\"b\",function(){return n}),a.d(i,\"c\",function(){return s}),a.d(i,\"d\",function(){return l}),a.d(i,\"a\",function(){return o});var e=a(\"b775\");function n(t,i){return Object(e[\"a\"])({url:t,method:\"get\",params:i})}function s(t,i){return Object(e[\"a\"])({url:t,method:\"post\",data:i})}function l(t,i){return Object(e[\"a\"])({url:t,method:\"put\",data:i})}function o(t,i){return Object(e[\"a\"])({url:t,method:\"delete\",data:i})}},\"16f7\":function(t,i){t.exports=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAADBAMAAACHXflZAAAAFVBMVEU7Zv87Zv87Zv87Zv87Zv87Zv87Zv8SjMEtAAAABnRSTlPg0GFRcFvMdUYhAAAAGElEQVQI12MwFISAAAa1NAhwYDBggAAFAEkSBHmbL3EsAAAAAElFTkSuQmCC\"},\"60cb\":function(t,i){t.exports=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAARBAMAAADJQ1rJAAAAJ1BMVEUAAAA7Zv87Zv87Zv87Zv87Zv87Zv87Zv87Zv87Zv87Zv87Zv87Zv+C3BOyAAAADHRSTlMA0PDggfmKeGigkHIq6oMXAAAANElEQVQI12MAArblDFDAdJBMVrKxsc1RY2PjDQxzzkCAA4OjoKDMUUFBwQayTYYCdg8QCQBVJhWbVQBKgAAAAABJRU5ErkJggg==\"},\"6a16\":function(t,i,a){\"use strict\";var e=a(\"bdf4\"),n=a.n(e);n.a},7433:function(t,i){t.exports=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAALVBMVEUAAAA7Zv87Zv87Zv87Zv87Zv87Zv87Zv87Zv87Zv87Zv87Zv87Zv87Zv87Zv/f4m3vAAAADnRSTlMAeC8fl+ADvrKlaU1FAkiZSrEAAABQSURBVAjXYwACRgEGCJB7CKEZ370TgAi8e/cQItD3HCwk98Tukd9DkICD3SOWdwJAAQa7RwxAITkHECPzFQP3BRCD7QBQNYgBBEQyTIOABABwIB7nLJ+yeQAAAABJRU5ErkJggg==\"},b887:function(t,i){t.exports=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAMFBMVEUAAAA7Zv87Zv87Zv87Zv87Zv87Zv87Zv87Zv87Zv87Zv87Zv87Zv87Zv87Zv87Zv/1M/EzAAAAD3RSTlMAeB8wl+ADvrKlaU1FKgKwo5P9AAAAT0lEQVQI12MAAtVYBgjQ/0wsg/sBiMF2gEHeAcTI/MUg/wXE8P/IwPjfQf8zy38BBqCQ/megAANQqP87SAAo9P8/UAAsBBIACwEFIEIgAQAUqiAWOaLasAAAAABJRU5ErkJggg==\"},bdf4:function(t,i,a){},e6f6:function(t,i,a){\"use strict\";a.r(i);var e=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e(\"div\",{staticClass:\"routeinstall\"},[e(\"div\",{staticClass:\"scroll_box\",attrs:{tag:\"ul\"}},[t.divtab?t._e():e(\"div\",[e(\"el-table\",{ref:\"singleTable\",staticStyle:{width:\"100%\"},attrs:{data:t.markers,\"highlight-current-row\":\"\"},on:{\"current-change\":t.handleCurrentChange}},[e(\"el-table-column\",{attrs:{type:\"expand\"},scopedSlots:t._u([{key:\"default\",fn:function(i){return[e(\"el-form\",{staticClass:\"demo-table-expand\",attrs:{\"label-position\":\"left\",inline:\"\"}},t._l(i.row.fanglist,function(i,a){return e(\"div\",{key:a,staticClass:\"row1\"},[e(\"div\",{staticClass:\"row2\"},[t._v(t._s(a+1))]),t._v(\" \"),e(\"div\",{staticClass:\"row2\"},[t._v(t._s(i.pointName))])])}),0)]}}],null,!1,2160188056)}),t._v(\" \"),e(\"el-table-column\",{attrs:{label:\"路线名称\",prop:\"label.content1\"}}),t._v(\" \"),e(\"el-table-column\",{attrs:{label:\"路线类型\",prop:\"label.vehiclesType2\"}}),t._v(\" \"),e(\"el-table-column\",{attrs:{label:\"操作\",prop:\"label.linetype\"},scopedSlots:t._u([{key:\"default\",fn:function(i){return[e(\"span\",{staticClass:\"bianshan\",on:{click:function(a){return t.bian(i)}}},[t._v(\"编辑\")]),t._v(\" \"),e(\"span\",{staticClass:\"bianshan\",on:{click:function(a){return t.shan(i)}}},[t._v(\"删除\")])]}}],null,!1,2117327751)})],1)],1),t._v(\" \"),t.divtab?t._e():e(\"el-button\",{staticStyle:{\"margin-left\":\"20%\",width:\"60%\",\"margin-top\":\"5%\"},attrs:{type:\"primary\",round:\"\"},on:{click:function(i){t.divtab=!t.divtab,t.linetab=\"\",t.currentRow=[]}}},[t._v(\"新建路线\")]),t._v(\" \"),t.divtab?e(\"div\",{staticClass:\"leftdiv\",attrs:{id:\"scroll\"}},[e(\"div\",{staticClass:\"leftdiv_list title_name\"},[t._v(\"车船线路\")]),t._v(\" \"),e(\"div\",{staticClass:\"leftdiv_list\"},[e(\"el-select\",{staticClass:\"elselect\",staticStyle:{float:\"right\"},attrs:{placeholder:\"请选择\"},model:{value:t.value,callback:function(i){t.value=i},expression:\"value\"}},t._l(t.options,function(t){return e(\"el-option\",{key:t.value,attrs:{label:t.label,value:t.value}})}),1),t._v(\"路线类型\"),e(\"div\",{staticClass:\"star\"},[t._v(\"*\")])],1),t._v(\" \"),e(\"div\",{staticClass:\"leftdiv_list\"},[e(\"div\",{staticClass:\"star\"},[t._v(\"*\")]),t._v(\"\\n        路线名称\\n        \"),e(\"el-input\",{attrs:{placeholder:\"请输入内容\"},model:{value:t.name,callback:function(i){t.name=i},expression:\"name\"}})],1),t._v(\" \"),e(\"div\",{staticClass:\"leftdiv_list\"},[t._v(\"\\n        路线备注\\n        \"),e(\"el-input\",{attrs:{placeholder:\"请输入内容\"},model:{value:t.bei,callback:function(i){t.bei=i},expression:\"bei\"}})],1),t._v(\" \"),e(\"div\",{staticClass:\"leftdiv_list\"},[e(\"div\",{staticClass:\"star\"},[t._v(\"*\")]),t._v(\"\\n        路线的站点\\n        \"),e(\"ul\",{staticClass:\"img_bg_box\"},[e(\"li\",{on:{click:function(i){return t.jia()}}},[e(\"img\",{attrs:{src:a(\"60cb\")}})]),t._v(\" \"),e(\"li\",{staticStyle:{position:\"relative\"},on:{click:function(i){return t.jian()}}},[e(\"img\",{staticStyle:{position:\"absolute\",top:\"9px\",left:\"0px\"},attrs:{src:a(\"16f7\")}})]),t._v(\" \"),e(\"li\",{on:{click:function(i){return t.shang()}}},[e(\"img\",{attrs:{src:a(\"7433\")}})]),t._v(\" \"),e(\"li\",{on:{click:function(i){return t.xia()}}},[e(\"img\",{attrs:{src:a(\"b887\")}})])])]),t._v(\" \"),e(\"div\",{staticClass:\"leftdiv_list\"},[e(\"el-table\",{ref:\"singleTable\",staticStyle:{width:\"100%\",\"font-size\":\"10px\"},attrs:{data:t.data,\"row-key\":\"\",\"highlight-current-row\":\"\",\"row-class-name\":t.tableRowClassName,\"header-cell-style\":{background:\"#EBEFF8\"}},on:{\"row-click\":t.onRowClick}},[e(\"el-table-column\",{attrs:{prop:\"单选\",type:\"index\",index:t.indexMethod,label:\"序号\"}}),t._v(\" \"),e(\"el-table-column\",{attrs:{label:\"名称\",prop:\"name\"},scopedSlots:t._u([{key:\"default\",fn:function(i){return[e(\"input\",{directives:[{name:\"model\",rawName:\"v-model\",value:i.row.name,expression:\"scope.row.name\"}],staticClass:\"datainp\",attrs:{type:\"text\",placeholder:\"请输入名称\"},domProps:{value:i.row.name},on:{input:function(a){a.target.composing||t.$set(i.row,\"name\",a.target.value)}}})]}}],null,!1,410530405)}),t._v(\" \"),e(\"el-table-column\",{attrs:{prop:\"indt\",label:\"定位\"}})],1)],1),t._v(\" \"),t._m(0),t._v(\" \"),e(\"div\",{staticClass:\"leftdiv_list\"},[e(\"el-select\",{staticStyle:{width:\"100%\"},attrs:{placeholder:\"请选择\"},model:{value:t.value2,callback:function(i){t.value2=i},expression:\"value2\"}},t._l(t.options2,function(t){return e(\"el-option\",{key:t.pid,attrs:{label:t.name,value:t.pid}})}),1)],1),t._v(\" \"),\"3\"==t.value?e(\"div\",{staticClass:\"leftdiv_list\"},[e(\"div\",{staticClass:\"star\"},[t._v(\"*\")]),t._v(\"\\n        首班车时间\\n        \"),e(\"el-time-select\",{attrs:{placeholder:\"起始时间\",\"picker-options\":{start:\"08:30:00\",step:\"00:15:00\",end:\"18:30:00\",format:\"HH:mm:ss\"}},model:{value:t.shijian,callback:function(i){t.shijian=i},expression:\"shijian\"}})],1):t._e(),t._v(\" \"),\"3\"==t.value?e(\"div\",{staticClass:\"leftdiv_list\"},[e(\"div\",{staticClass:\"star\"},[t._v(\"*\")]),t._v(\"\\n        末班车时间\\n        \"),t._v(\" \"),e(\"el-time-select\",{attrs:{placeholder:\"结束时间\",\"picker-options\":{start:\"08:30:00\",step:\"00:15:00\",end:\"18:30:00\",format:\"HH:mm:ss\",minTime:t.shijian}},model:{value:t.shijian2,callback:function(i){t.shijian2=i},expression:\"shijian2\"}})],1):t._e(),t._v(\" \"),\"3\"==t.value?e(\"div\",{staticClass:\"leftdiv_list\"},[e(\"div\",{staticClass:\"star\"},[t._v(\"*\")]),t._v(\"\\n        间隔时间(分钟)\\n        \"),e(\"el-input-number\",{staticStyle:{float:\"right\"},attrs:{min:0,max:300,size:\"small\"},model:{value:t.shijian3,callback:function(i){t.shijian3=i},expression:\"shijian3\"}})],1):t._e(),t._v(\" \"),e(\"div\",{staticClass:\"leftdiv_list\"},[e(\"el-button\",{staticStyle:{float:\"left\",\"margin-right\":\"15%\"},attrs:{type:\"primary\",round:\"\"},on:{click:function(i){t.divtab=!t.divtab}}},[t._v(\"返回\")]),t._v(\" \"),e(\"el-button\",{staticStyle:{float:\"right\",\"margin-right\":\"15%\"},attrs:{type:\"primary\",round:\"\"},on:{click:function(i){return t.ti()}}},[t._v(\"保存\")])],1)]):t._e()],1),t._v(\" \"),e(\"el-amap\",{staticClass:\"map map_box\",attrs:{vid:\"amap-vue\",zoom:t.zoom,center:t.center,\"map-style\":t.mapStyle1,events:t.events,\"amap-manager\":t.amapManager}},t._l(t.markers,function(i,a){return e(\"div\",{key:a},[e(\"el-amap-polyline\",{attrs:{path:i.path,\"stroke-color\":t.linetab==i.id?t.linecolor:t.linecolor2,\"z-index\":t.linetab==i.id?120:100}}),t._v(\" \"),t._l(i.path,function(a,n){return e(\"div\",{key:n},[e(\"el-amap-marker\",{attrs:{position:a,vid:n,content:t.linecontent(n,i),\"z-index\":t.linetab==i.id?120:100}})],1)})],2)}),0),t._v(\" \"),t.tank?e(\"div\",{staticClass:\"tank\"},[t._v(\"\\n    \"+t._s(t.tank)+\"\\n  \")]):t._e()],1)},n=[function(){var t=this,i=t.$createElement,a=t._self._c||i;return a(\"div\",{staticClass:\"leftdiv_list\"},[a(\"div\",{staticClass:\"star\"},[t._v(\"*\")]),t._v(\"绑定设备\")])}],s=(a(\"7f7f\"),a(\"8f9b\")),l=a.n(s),o=a(\"0d5e\"),r=new l.a.AMapManager,c={name:\"Map\",data:function(){return{divtab:!1,linecolor:\"#e79f3c\",linecolor2:\"#7f85f5\",linetab:\"1\",tank:\"\",currentRow:\"\",name:\"\",bei:\"\",zoom:16,center:[116.336496,39.942178],mapStyle1:\"amap://styles/whitesmoke\",amapManager:r,events:{},overlayGroups:[],data:[],rowindex:\"\",dataid:0,options:[{value:\"1\",label:\"小火车\"},{value:\"2\",label:\"缆车\"},{value:\"3\",label:\"大巴\"},{value:\"4\",label:\"游船\"}],value:\"\",options2:[{value:\"1\",label:\"单兵\"},{value:\"2\",label:\"对讲机\"}],value2:\"\",line:\"\",markers:[],shijian:\"\",shijian2:\"\",shijian3:\"\"}},computed:{isopen:function(){return this.value&&this.name&&this.value2&&this.data}},watch:{data:function(){},divtab:function(){this.divtab||(this.data=[],this.name=\"\",this.bei=\"\",this.value=\"\",this.value2=\"\",this.shijian=\"\",this.shijian2=\"\",this.shijian3=\"\",this.addmarker())}},created:function(){this.addfun(),this.shebei(),this.shua()},methods:{vehiclesType:function(t){for(var i=0;i<this.options.length;i++)if(t===this.options[i].value)return this.options[i].label},handleCurrentChange:function(t){this.currentRow=t,this.linetab=t.id},shebei:function(){var t=this;Object(o[\"b\"])(\"/camara/getEqType?\",{cpid:this.$store.state.user.companyId,system_id:2}).then(function(i){console.log(i),t.options2=i})},shua:function(){var t=this;Object(o[\"b\"])(\"/mngCircuitInfo/getmngcircuitinfobytype\",{cpid:this.$store.state.user.companyId,typeid:2}).then(function(i){console.log(i);var a=i.data;t.markers=[];for(var e=0;e<a.length;e++){for(var n=[],s=0;s<a[e].circuitpointlist.length;s++)n.push([a[e].circuitpointlist[s].circuitPointLon,a[e].circuitpointlist[s].circuitPointLat]);t.markers.push({id:a[e].id,position:[a[e].circuitpointlist[a[e].circuitpointlist.length-1].circuitPointLon,a[e].circuitpointlist[a[e].circuitpointlist.length-1].circuitPointLat],label:{content1:a[e].circuitName,linetype:a[e].circuitType,remark:a[e].remark,vehiclesType:a[e].vehiclesType,vehiclesType2:t.vehiclesType(a[e].vehiclesType+\"\"),equimentId:a[e].equimentId+\"\",shijian:a[e].firstBusTime,shijian2:a[e].lastBusTime,shijian3:a[e].busIntervalTime},path:n,fanglist:a[e].circuitpointlist})}console.log(t.markers)})},linecontent:function(t,i){return t+1===i.path.length?'<div style=\"height: 20px; width: 20px;color: #fff; line-height: 20px; border-radius: 20px; font-size: 12px; text-align: center; background-color: #fd3d10;margin-left:1px; margin-top: 21px;\">终<div>':0===t?'<div style=\"height: 20px; width: 20px;color: #fff; line-height: 20px; border-radius: 20px; font-size: 12px; text-align: center; background-color: #07a803;margin-left:1px; margin-top: 21px;\">起<div>':'<div style=\"height: 15px; width: 15px; border: 1.5px solid  #7f85f5; border-radius: 15px; background-color: rgba(255,255,255, 1);margin-left:3px; margin-top: 23px;\"></div>'},bian:function(t){console.log(t),this.divtab=!this.divtab,this.linetab=t.row.id,this.name=t.row.label.content1,this.bei=t.row.label.remark,this.value=t.row.label.vehiclesType+\"\",this.value2=t.row.label.equimentId,this.shijian=t.row.label.shijian,this.shijian2=t.row.label.shijian2,this.shijian3=t.row.label.shijian3,this.data=[];for(var i=0;i<t.row.fanglist.length;i++)this.data.push({id:t.row.fanglist[i].id,name:t.row.fanglist[i].pointName,indt:[t.row.fanglist[i].circuitPointLon,t.row.fanglist[i].circuitPointLat]})},shan:function(t){var i=this;console.log(t.row.id),Object(o[\"b\"])(\"/mngCircuitInfo/delmngcircuitinfobyid\",{id:t.row.id}).then(function(t){console.log(t),i.shua()})},ti:function(){var t=this;if(\"\"!==this.name&&\"\"!==this.value&&\"\"!==this.value2){for(var i=[],a=0;a<this.data.length;a++)i.push({pointName:this.data[a].name,circuitName:this.name,orderNumber:a+1,circuitPointLon:this.data[a].indt[0],circuitPointLat:this.data[a].indt[1]}),this.data[a].id&&(i[a].id=this.data[a].id);var e={cpid:this.$store.state.user.companyId,circuitTypeId:2,circuitType:\"车船\",vehiclesType:this.value,circuitName:this.name,remark:this.bei,circuitpointlist:i,equimentId:1*this.value2};1*this.value===3&&(e.firstBusTime=this.shijian.substring(0,5)+\":00\",e.lastBusTime=this.shijian2.substring(0,5)+\":00\",e.busIntervalTime=this.shijian3),\"\"!==this.linetab&&(e.id=this.linetab),Object(o[\"c\"])(\"/mngCircuitInfo/savemngcircuitinfo\",e).then(function(i){Object(o[\"c\"])(\"/camara/updpoint\",{pid:1*e.equimentId,binding:1}).then(function(i){t.divtab=!t.divtab,t.shebei(),t.shua(),t.$message({message:\"保存成功\",type:\"success\"})})})}else this.$message({message:\"请认真检查填写项\",type:\"warning\"})},addfun:function(){var t=this;this.events={init:function(i){i.on(\"click\",function(i){t.wei(i.lnglat.getLng(),i.lnglat.getLat(),t)})}}},addmarker:function(){console.log(123);var t=this,i=r.getMap(),a=[],e=[];i.remove(t.overlayGroups),i.remove(t.line);for(var n=0;n<t.data.length;n++)if(\"\"!==t.data[n].indt){var s=new AMap.Marker({position:t.data[n].indt,rowindex:t.rowindex,text:\"123\",icon:\"https://webapi.amap.com/theme/v1.3/markers/n/mark_b\"+(a.length+1)+\".png\"});s.on(\"click\",function(){console.log(\"111\")}),e.push(t.data[n].indt),a.push(s)}e.length>1&&(console.log(e),t.line=new AMap.Polyline({map:i,strokeColor:\"#80d8ff\",isOutline:!0,strokeStyle:\"dashed\",outlineColor:\"white\",path:e})),this.overlayGroups=new AMap.OverlayGroup(a),i.add(t.overlayGroups)},wei:function(t,i,a){console.log(a.rowindex),\"\"!==a.rowindex?a.data[a.rowindex].indt=[t,i]:a.data[a.dataid].indt=[t,i],this.addmarker()},handleClick:function(t,i){console.log(t,i)},jia:function(){this.data.push({name:\"\",indt:\"\"}),this.dataid=this.data.length-1,this.rowindex=this.dataid,this.$refs.singleTable.setCurrentRow(this.data[this.dataid])},datafun:function(t){console.log(t),this.dataid=t},jian:function(){this.rowindex||0===this.rowindex?this.data.splice(this.rowindex,1):this.data.splice(this.dataid,1),this.rowindex=this.data.length-1,this.$refs.singleTable.setCurrentRow(this.data[this.data.length-1]),this.addmarker()},shang:function(){if(this.dataid>1||1===this.dataid){var t=this.data[this.dataid];this.data[this.dataid]=this.data[this.dataid-1],this.data[this.dataid-1]=t,this.dataid-=1,this.$refs.singleTable.setCurrentRow(this.data[this.dataid])}this.addmarker()},xia:function(){if(console.log(this.rowindex),console.log(this.dataid),this.dataid!==this.data.length-1&&this.data.length>1){var t=this.data[this.dataid];this.data[this.dataid]=this.data[this.dataid+1],this.data[this.dataid+1]=t,this.dataid+=1,this.$refs.singleTable.setCurrentRow(this.data[this.dataid])}this.addmarker()},indexMethod:function(t){return t+1},tableRowClassName:function(t){var i=t.row,a=t.rowIndex;i.index=a},onRowClick:function(t,i,a){var e=t.index;this.rowindex=e,this.dataid=e,console.log(this.data)}}},d=c,u=(a(\"6a16\"),a(\"2877\")),h=Object(u[\"a\"])(d,e,n,!1,null,\"67e61434\",null);i[\"default\"]=h.exports}}]);","extractedComments":[]}