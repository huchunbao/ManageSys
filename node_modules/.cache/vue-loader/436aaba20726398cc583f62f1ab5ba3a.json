{"remainingRequest":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\办公\\projectwc\\前端\\ManageSys\\src\\views\\onecard\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\src\\views\\onecard\\index.vue","mtime":1576820780362},{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\n/* eslint-disable */\r\nimport echarts from 'echarts'\r\nimport { get } from '@/api/axios'\r\nexport default {\r\n /* eslint-disable */\r\n  name: 'onecard',\r\n  data() {\r\n    return {\r\n      //tab按钮\r\n      // tab: [\"标题一\",\"标题二\",\"标题三\"],\r\n      // default_bar: 0,\r\n      thismonthreCharge: '', // 本月充值金额\r\n      thismonthChargeSame: '', // 本月充值同比\r\n      thismonthChargeDis: '', // 本月充值环比\r\n      thismonthIncome: '', // 本月消费金额\r\n      thismonthSame: '', // 本月消费同比\r\n      thismonthDis: '' , //, 本月消费环比\r\n      thisweekChargeIncome: '', // 本周充值金额\r\n      thisweekChargeSame: '' , // 本周充值金额同比\r\n      thisweekChargeDis: '' , // 本周充值金额环比\r\n      thisweekIncome: '' , // 本周消费\r\n      thisweekSame: '', // 同\r\n      thisweekDis : '', // 环\r\n      totalNum: '',// 总数\r\n      usedTotalNum: '',// 已使用\r\n      restTotalNum: '',// 未使用\r\n      ehcart1: null,\r\n      ehcart2: null,\r\n      ehcart3: null\r\n    }\r\n  },\r\n  mounted() {\r\n    // this.TabClick(0)\r\n    var that = this\r\n    this.$nextTick(() => {\r\n      get('income/findIPassIncome').then(data => {\r\n        if (data.msg === \"SUCCESS\") {\r\n          var sourceMap = data.data.sourceMap\r\n          var data = data.data.list\r\n          var ring_series = [] // 一卡通腕带环状图\r\n          var left_lend = [], left_series = [] //消费额占比\r\n          var right_legend = [] , right_series = [], \r\n          data_9 = [0,0,0,0,0,0,0,0,0,0,0,0], data_10 = [0,0,0,0,0,0,0,0,0,0,0,0], data_11 = [0,0,0,0,0,0,0,0,0,0,0,0], data_12 = [0,0,0,0,0,0,0,0,0,0,0,0]// 消费趋势list_data--为循环添加的data数组\r\n          for (var i = 0 ; i < data.length; i++) {\r\n            if (data[i].dateYear == 8) {\r\n              that.thismonthreCharge = data[i].thismonthreCharge ? data[i].thismonthreCharge : 0\r\n              that.thismonthChargeSame = data[i].thismonthChargeSame ? data[i].thismonthChargeSame : 0\r\n              that.thismonthChargeDis = data[i].thismonthChargeDis ? data[i].thismonthChargeDis : 0\r\n              that.thismonthIncome = data[i].thismonthIncome ? data[i].thismonthIncome : 0\r\n              that.thismonthSame = data[i].thismonthSame ? data[i].thismonthSame : 0\r\n              that.thismonthDis = data[i].thismonthDis ? data[i].thismonthDis : 0\r\n\r\n              that.thisweekChargeIncome = data[i].thisweekChargeIncome ? data[i].thisweekChargeIncome : 0\r\n              that.thisweekChargeSame = data[i].thisweekChargeSame ? data[i].thisweekChargeSame : 0\r\n              that.thisweekChargeDis = data[i].thisweekChargeDis ? data[i].thisweekChargeDis : 0\r\n              that.thisweekIncome = data[i].thisweekIncome ? data[i].thisweekIncome : 0\r\n              that.thisweekSame = data[i].thisweekSame ? data[i].thisweekSame : 0\r\n              that.thisweekDis = data[i].thisweekDis ? data[i].thisweekDis : 0\r\n              // 总数 totalNum\r\n              // 已使用 usedTotalNum\r\n              // 剩余 restTotalNum\r\n              that.totalNum = data[i].totalNum\r\n              ring_series =[\r\n                {'value':data[i].usedTotalNum, 'name':'已使用数量'},\r\n                {'value':data[i].restTotalNum, 'name':'未使用数量'}]\r\n            } else if (data[i].dateYear == 1) {\r\n              left_lend.push(data[i].sourceName)\r\n              left_series.push({'value': data[i].imcomeValue, 'name': data[i].sourceName})\r\n            } \r\n            else if (data[i].dateYear == 0 && data[i].sourceId == 9) {\r\n              if (data[i].dateName) {\r\n                data_9[parseInt(data[i].dateName) -1] = data[i].imcomeValue\r\n              }\r\n            } else if (data[i].dateYear == 0 && data[i].sourceId == 10) {\r\n              if (data[i].dateName) {\r\n                data_10[parseInt(data[i].dateName) -1] = (data[i].imcomeValue)\r\n              }\r\n            } else if (data[i].dateYear == 0 && data[i].sourceId == 11) {\r\n              if (data[i].dateName) {\r\n                data_11[parseInt(data[i].dateName) - 1] = (data[i].imcomeValue)\r\n              }\r\n            } else if (data[i].dateYear == 0 && data[i].sourceId == 12) {\r\n              if (data[i].dateName) {\r\n                data_12[parseInt(data[i].dateName) -1] = (data[i].imcomeValue)\r\n              }\r\n            }\r\n          }\r\n          var data_type = [data_9 , data_10 , data_11, data_12]\r\n\r\n          for (var x = 0 ; x < sourceMap.length ; x++) {\r\n            right_legend.push( {'name':sourceMap[x].sourceName,'icon':'circle'})\r\n            right_series.push({'name':sourceMap[x].sourceName,'type':'line','data':data_type[x]})\r\n          }\r\n          that.EchartsRing(ring_series)\r\n          left_lend = left_lend.reverse()\r\n          that.EchartsRing_bottom_left(left_lend, left_series)\r\n          that.MoreLine(right_legend, right_series)\r\n        }\r\n      })\r\n    })\r\n  },\r\n  beforeDestroy() {\r\n    window.removeEventListener('resize', this.resizeHandler)\r\n  },\r\n  methods: {\r\n    // TabClick(index){\r\n    // this.default_bar = index\r\n    // },\r\n    EchartsRing(ring_series){\r\n      var that = this\r\n      that.ehcart1 = echarts.init(document.getElementById('echartsbox'));\r\n      // color: ['#89A2FF','#A2BCFF','#FF9F9C','#FFDC79'],//扇形区域以及列表颜色\r\n      var option = {\r\n        title: {\r\n          show:ring_series.length < 1,\r\n          textStyle: {\r\n            color: '#909399',\r\n            fontWeight: 'normal',\r\n            fontSize: 14\r\n          },\r\n          text: '暂无数据',\r\n          left: 'center',\r\n          top: 'center'\r\n        },\r\n        tooltip: {\r\n          trigger: 'item',\r\n            // formatter: \"{a} <br/>{b}: {c} ({d}%)\"\r\n            hoverAnimation: true,\r\n            formatter:\r\n            function(params){\r\n              var result =''\r\n              // result =params.seriesName+''+\"</br>\"\r\n              result += params.seriesName +\"</br>\"+params.marker + \" \" + params.data.name + \" : \" + params.data.value+'('+params.percent+'%'+')' +\"</br>\"\r\n              return result\r\n            }\r\n        },\r\n        legend: {\r\n          orient: 'vertical',\r\n          icon: \"circle\",\r\n          x: '75%',\r\n          y:'center',\r\n          data:['已使用数量','未使用数量']\r\n        },\r\n        color: ['#89A2FF', '#FF9F9C'], // 扇形区域以及列表颜色\r\n        series: [\r\n          {\r\n            name:'一卡通',\r\n            type:'pie',\r\n            legendHoverLink:true,\r\n            // radius: ['38%', '68%'],\r\n            // center:[\"50%\",'60%'],\r\n            center: ['40%', '55%'],\r\n            radius: ['30%', '50%'],\r\n            minAngle: 5, // 最小的扇区角度（0 ~ 360），用于防止某个值过小导致扇区太小影响交互\r\n            avoidLabelOverlap: true, // 是否启用防止标签重叠策略\r\n            hoverAnimation: true, // 是否开启 hover 在扇区上的放大动画效\r\n            labelLine: { // 设置延长线的长度\r\n              normal: {\r\n                show:true,\r\n                length: 15, // 设置延长线的长度\r\n                // length2: 10,//设置第二段延长线的长度\r\n               }\r\n            },\r\n            label: {\r\n              normal: {\r\n                show: true,\r\n                formatter: function(params) {\r\n                  var result =''\r\n                  // result =params.seriesName+''+\"</br>\"\r\n                  result +=  params.data.value+'('+params.percent+'%'+')'\r\n                  return result\r\n                }\r\n              },\r\n              emphasis:{\r\n                show:true,\r\n                textStyle:{\r\n                  // fontSize:'16',\r\n                  // fontWeight:'bold'\r\n                }\r\n              }\r\n            },\r\n            data:ring_series\r\n          }\r\n        ]\r\n      }\r\n      that.ehcart1.setOption(option)\r\n      window.addEventListener('resize', that.resizeHandler)\r\n    },\r\n    EchartsRing_bottom_left(data_legend, data_series){\r\n      // var data_legend = ['餐饮','零食','酒店','其他']\r\n      // var data_series = [\r\n      //   {value:335, name:'餐饮'},\r\n      //   {value:310, name:'零食'},\r\n      //   {value:234, name:'酒店'},\r\n      //   {value:135, name:'其他'}\r\n      // ]\r\n      var that = this\r\n      that.ehcart2 = echarts.init(document.getElementById('echartslinecolumn'))\r\n      var option = {\r\n        title: {\r\n          show:data_legend.length < 1 && data_series.length < 1,\r\n          textStyle: {\r\n            color: '#909399',\r\n            fontWeight: 'normal',\r\n            fontSize: 14\r\n          },\r\n          text: '暂无数据',\r\n          left: 'center',\r\n          top: 'center'\r\n        },\r\n        tooltip: {\r\n          trigger: 'item',\r\n          // formatter: \"{a} <br/>{b}: {c} ({d}%)\"\r\n          hoverAnimation: true,\r\n          formatter: function(params) {\r\n            var result =''\r\n            //  result =params.seriesName+''+\"</br>\" ;\r\n            result += params.seriesName +\"</br>\"+params.marker + \" \" + params.data.name + \" : \" + params.data.value+'('+params.percent+'%'+')' +\"</br>\"\r\n            return result\r\n          }\r\n        },\r\n        legend: {\r\n          orient: 'vertical',\r\n          icon: \"circle\",\r\n          x: '80%',\r\n          y:'center',\r\n          data:data_legend\r\n        },\r\n        color: ['#FFDC79','#FF9F9C','#A2BCFF','#89A2FF'],//扇形区域以及列表颜色\r\n        series: [\r\n          {\r\n            name:'消费来源',\r\n            type:'pie',\r\n            center: ['40%', '55%'],\r\n            radius: ['30%', '50%'],\r\n            minAngle: 5, // 最小的扇区角度（0 ~ 360），用于防止某个值过小导致扇区太小影响交互\r\n            avoidLabelOverlap: true, // 是否启用防止标签重叠策略\r\n            hoverAnimation: true, // 是否开启 hover 在扇区上的放大动画效\r\n            labelLine: { // 设置延长线的长度\r\n              normal: {\r\n                show:true,\r\n                length: 15, // 设置延长线的长度\r\n                // length2: 10,//设置第二段延长线的长度\r\n                }\r\n            },\r\n            label: {\r\n              normal: {\r\n                show: true,\r\n                formatter: function(params) {\r\n                  var result =''\r\n                  //  result =params.seriesName+''+\"</br>\"\r\n                  result += params.data.value+'('+params.percent+'%'+')'\r\n                  return result\r\n                }\r\n              },\r\n              emphasis:{\r\n                show:true,\r\n                textStyle:{\r\n                  // fontSize:'16',\r\n                  // fontWeight:'bold'\r\n                }\r\n              }\r\n            },\r\n            data:data_series\r\n          }\r\n        ]\r\n      }\r\n      that.ehcart2.setOption(option)\r\n      window.addEventListener('resize', that.resizeHandler)\r\n    },\r\n    MoreLine(right_legend, right_series){\r\n      var that = this\r\n      var rightx = ['1','2','3','4','5','6','7','8','9','10','11','12']\r\n      // var right_legend = [\r\n      //       {name:'餐饮',icon:'circle'},\r\n      //       {name:'零食',icon:'circle'},\r\n      //       {name:'酒店',icon:'circle'},\r\n      //       {name:'其他',icon:'circle'}\r\n      //     ]\r\n      // var right_series = [\r\n      //     {\r\n      //       name:'餐饮',\r\n      //       type:'line',\r\n      //       data:data_9\r\n      //     },\r\n      //     {\r\n      //       name:'零食',\r\n      //       type:'line',\r\n      //       // yAxisIndex: 1,\r\n      //       data:data_10\r\n      //     },\r\n      //     {\r\n      //       name:'酒店',\r\n      //       type:'line',\r\n      //       // yAxisIndex: 1,\r\n      //       data:data_11\r\n      //     },\r\n      //     {\r\n      //       name:'其他',\r\n      //       type:'line',\r\n      //       // yAxisIndex: 1,\r\n      //       data:data_12\r\n      //     }\r\n      //   ]\r\n      var option = {\r\n        title: {\r\n          show:right_legend.length < 1 && right_series.length < 1,\r\n          textStyle: {\r\n            color: '#909399',\r\n            fontWeight: 'normal',\r\n            fontSize: 14\r\n          },\r\n          text: '暂无数据',\r\n          left: 'center',\r\n          top: 'center'\r\n        },\r\n        grid: {\r\n          left: '20',\r\n          right: '70',\r\n          bottom: '50'\r\n        },\r\n        tooltip: {\r\n          trigger: 'axis',\r\n          axisPointer: {\r\n            type: 'cross'\r\n          },\r\n          formatter: function(params) {\r\n            var result =''\r\n            result =params[0].name+'月各店消费额'+\"</br>\"\r\n            params.forEach(function(item){\r\n              result+= item.marker + \" \" + item.seriesName + \" : \" + item.value +\"</br>\"\r\n            })\r\n            return result;\r\n          }\r\n          // \"{b}月会员积分情况 <br/>{a} :{c}<br/>{a1}: {c1}\"\r\n          // a ---legend第一个 名字  a1---第二个名字\r\n          // b --- 第一个表x轴\r\n          // b1 --- 第二标x轴\r\n          // c  ---第一个y轴值\r\n          // c1 ---第二个y轴值\r\n        },\r\n        legend: { // 'circle', 'rect', 'roundRect', 'triangle', 'diamond', 'pin', 'arrow', 'none'\r\n          data:right_legend\r\n        },\r\n        color: ['#89A2FF','#A2BCFF','#FF9F9C','#FFDC79'],//扇形区域以及列表颜色\r\n        xAxis: [{\r\n          type: 'category',\r\n          name: '日期(月)',\r\n          splitLine:{\r\n            show:false\r\n          },\r\n          data: rightx,\r\n          // axisPointer: {\r\n          // type: 'shadow'//轴线是线还是柱形   'line' 直线指示器 'shadow' 阴影指示器'none' 无指示器\r\n          // }, \r\n          axisTick: {\r\n            alignWithLabel: true,\r\n            show:false\r\n          }\r\n        }],\r\n        yAxis: [{\r\n          type: 'value',\r\n          name: '积分(分)',\r\n          splitLine:{\r\n            show:false\r\n          },\r\n          axisTick:{\r\n            show:false\r\n          },\r\n          axisLabel: {\r\n            formatter: '{value}'\r\n          },\r\n        }],\r\n        series: right_series\r\n      }\r\n      that.ehcart3 = echarts.init(document.getElementById('moreline'));\r\n      option.grid.left = this.getYWidth(Math.max.apply(null, option.series[0].data), Math.max.apply(null, option.series[0].data))\r\n      that.ehcart3.setOption(option)\r\n      window.addEventListener('resize', that.resizeHandler)\r\n    },\r\n    resizeHandler() {\r\n      if (this.ehcart1) {\r\n        this.ehcart1.resize()\r\n      }\r\n      if (this.ehcart2) {\r\n        this.ehcart2.resize()\r\n      }\r\n      if (this.ehcart3) {\r\n        this.ehcart3.resize()\r\n      }\r\n    },\r\n    getYWidth(data1, data2) { // 根据数值长度计算显示宽度\r\n      return ((data1 > data2 ? data1.toString().length : data2.toString().length) * 12).toString()\r\n    }\r\n  }\r\n}\r\n",null]}