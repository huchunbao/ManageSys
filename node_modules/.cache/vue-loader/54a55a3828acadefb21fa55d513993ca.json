{"remainingRequest":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\办公\\projectwc\\前端\\ManageSys\\src\\views\\car\\components\\CarSearch.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\src\\views\\car\\components\\CarSearch.vue","mtime":1577252313300},{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { parseTime } from '@/utils'\n\nexport default {\n  name: 'CarSearch',\n  props: {\n    searchType: {\n      type: String,\n      default: 'xs'\n    },\n    nameList: {\n      type: Array,\n      'default': null\n    },\n    tabIndex: {\n      type: Number,\n      default: 0\n    }\n  },\n  data() {\n    return {\n      pickerOptions: {\n        shortcuts: [{\n          text: '最近一周',\n          onClick(picker) {\n            const end = new Date()\n            const start = new Date()\n            start.setTime(start.getTime() - 3600 * 1000 * 24 * 7)\n            picker.$emit('pick', [start, end])\n          }\n        }, {\n          text: '最近一个月',\n          onClick(picker) {\n            const end = new Date()\n            const start = new Date()\n            start.setTime(start.getTime() - 3600 * 1000 * 24 * 30)\n            picker.$emit('pick', [start, end])\n          }\n        }, {\n          text: '最近三个月',\n          onClick(picker) {\n            const end = new Date()\n            const start = new Date()\n            start.setTime(start.getTime() - 3600 * 1000 * 24 * 90)\n            picker.$emit('pick', [start, end])\n          }\n        }]\n      },\n      time: [],\n      carName: '选择车辆',\n      carNameId: -1,\n      speedNumInput: '',\n      speedTimeInput: '',\n      intervalInput: '',\n      durationInput: '',\n      power: '',\n      carAlarm: '全部报警',\n      alarmList: ['全部报警', '断电报警', '超速报警', '超时报警', '区域报警'],\n      searchLoading: false,\n      downloadLoading: false,\n      queryData: []\n    }\n  },\n  created() {\n    const now = new Date()\n    var startDate = new Date(Date.UTC(now.getFullYear(), now.getMonth(), 1)).toLocaleString().slice(0, 10) // 开始事件初始化本月第一天\n    var endDate = now\n    this.time.push(startDate)\n    this.time.push(endDate)\n  },\n  methods: {\n    handleCommand(command) { // 车船列表选择\n      this.carName = command.veh_code\n      this.carNameId = command.id\n    },\n    handleCommandAlarm(command) {\n      this.carAlarm = command\n    },\n    btnSearch() { // 查询按钮事件\n      let startTime = ''\n      let endTime = ''\n      let vehCode = ''\n      if (this.time === null) {\n        this.$message({\n          message: '请选择日期',\n          type: 'warning',\n          duration: 3000\n        })\n        return\n      }\n      if (this.time.length > 0) {\n        startTime = parseTime(this.time[0])\n        endTime = parseTime(this.time[1])\n      }\n      if (this.carNameId > 0) {\n        vehCode = this.carName\n      }\n\n      if (this.searchType === 'lsgj' && vehCode === '') {\n        this.$message({\n          message: '请选择车辆',\n          type: 'warning',\n          duration: 3000\n        })\n        return\n      }\n\n      const query = {\n        'startTime': startTime,\n        'endTime': endTime,\n        'id': null,\n        'vehCode': vehCode,\n        'pageNum': 1,\n        'pageSize': 5\n      }\n\n      switch (this.searchType) { // 生成查询条件\n        case 'cs':\n          this.queryData = Object.assign(query, { 'speedValue': this.speedNumInput, 'speedTime': this.speedTimeInput })\n          break\n        case 'wz':\n          this.queryData = Object.assign(query, { 'intervalTime': this.intervalInput })\n          break\n        case 'tc':\n          this.queryData = Object.assign(query, { 'intervalTime': this.durationInput })\n          break\n        case 'sbxx':\n          this.queryData = Object.assign(query, { 'power': this.power })\n          break\n        case 'jy':\n          this.queryData = Object.assign(query, { 'oilType': 0 })\n          break\n        case 'ly':\n          this.queryData = Object.assign(query, { 'oilType': 1 })\n          break\n        case 'bjxx':\n          this.queryData = Object.assign(query, { 'alarm': this.carAlarm })\n          break\n        default:\n          this.queryData = query\n          break\n      }\n      this.searchLoading = true\n      this.$emit('search', this.tabIndex, this.queryData)\n    },\n    btnExcel() {\n      this.downloadLoading = true\n      this.$emit('excel', this.tabIndex, this.queryData)\n    }\n  }\n}\n",null]}