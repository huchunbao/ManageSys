{"remainingRequest":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\办公\\projectwc\\前端\\ManageSys\\src\\views\\alarm\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\src\\views\\alarm\\index.vue","mtime":1578016623671},{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport echarts from 'echarts'\nimport { get, post } from '../../api/axios.js'\nexport default {\n  name: 'About',\n  data() {\n    return {\n      sure: 0,\n      clear: 0,\n      nosure: 0,\n      noclear: 0,\n      gjing: '',\n      arrdata: [],\n      multipleTable: [],\n      arr: [],\n      pagesize: 3,\n      pageNumber: 2,\n      all: 0, //      总页数\n      cur: 1,\n      data: {},\n      seldata: '1',\n      open1: {\n        color: ['#8aa3ff'],\n        tooltip: {\n          trigger: 'axis',\n          axisPointer: {\n            type: 'cross'\n          },\n          formatter: '<br>{b}:告警数量为{c}次'\n        },\n        xAxis: {\n          type: 'category',\n          data: ['0', '2', '4', '6', '8', '10', '12', '14', '16', '18', '20', '22', '24']\n        },\n        yAxis: {\n          type: 'value',\n          splitLine: {\n            show: false\n          },\n          axisLabel: { formatter: '{value} 次' }\n        },\n        series: [\n          {\n            data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n            type: 'line',\n            smooth: true\n          }\n        ]\n      },\n      open2: {\n        color: [\n          '#8aa3ff',\n          '#96bbf2',\n          '#c2d8ff',\n          '#e4e6ff',\n          '#ff999a',\n          '#ffdd65',\n          '#d4c0ff'\n        ],\n        legend: {\n          data: ['告警数', '已确认', '已清除']\n        },\n        tooltip: {\n          trigger: 'item',\n          formatter: '{b}<br>{a}{c}次'\n        },\n        xAxis: {\n          type: 'category',\n          data: ['今日', '昨日']\n        },\n        yAxis: {\n          type: 'value',\n          axisLabel: { formatter: '{value} 次' },\n          splitLine: {\n            show: false\n          }\n        },\n        series: [\n          {\n            type: 'bar',\n            name: '告警数',\n            data: []\n          },\n          {\n            type: 'bar',\n            name: '已确认',\n            data: []\n          },\n          {\n            type: 'bar',\n            name: '已清除',\n            data: []\n          }\n        ]\n      },\n      zhdata: {},\n      zh: false,\n      multipleSelection: []\n    }\n  },\n  computed: {},\n  watch: {\n    seldata() {\n      this.open1.series[0].data = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]\n      this.jinzuoif()\n    }\n  },\n  mounted() {\n    this.snowTurnoveraa()\n    this.shua()\n    this.jinzuoif()\n  },\n  methods: {\n    jinzuoif() {\n      if (this.seldata === '1') {\n        this.jin()\n      } else {\n        this.zuo()\n      }\n    },\n    shua() {\n      var that = this\n      get('/alarmInfo/selectByIdAndClear', {\n        cpid: this.$store.state.user.companyId,\n        pageNum: that.cur - 1,\n        pageSize: 5\n      }).then(res => {\n        that.arrdata = res.content\n        that.all = res.totalElements\n      })\n      get('/alarmInfo/selectCountToday', {\n        cpid: this.$store.state.user.companyId\n      }).then(res => {\n        if (res['所有告警'] !== null) {\n          that.gjing = res['所有告警']\n        } else {\n          that.gjing = 0\n        }\n        if (res['已确认'] !== null) {\n          that.sure = res['已确认']\n        } else {\n          that.sure = 0\n        }\n        if (res['已清除'] !== null) {\n          that.clear = res['已清除']\n        } else {\n          that.clear = 0\n        }\n        if (res['未确认'] !== null) {\n          that.nosure = res['未确认']\n        } else {\n          that.nosure = 0\n        }\n        if (res['未清除'] !== null) {\n          that.noclear = res['未清除']\n        } else {\n          that.noclear = 0\n        }\n      })\n    },\n    jin() {\n      get('/alarmInfo/countTimeAndNumToday', {\n        cpid: this.$store.state.user.companyId\n      }).then(res => {\n        for (var i = 0; i < this.open1.xAxis.data.length; i++) {\n          for (var i2 = 0; i2 < res.length; i2++) {\n            if (this.open1.xAxis.data[i] === res[i2].c_hour) {\n              this.open1.series[0].data[i] = res[i2].num\n            }\n          }\n        }\n        this.snowTurnover()\n      })\n    },\n    zuo() {\n      get('/alarmInfo/countTimeAndNumYesterday', {\n        cpid: this.$store.state.user.companyId\n      }).then(res => {\n        for (var i = 0; i < this.open1.xAxis.data.length; i++) {\n          for (var i2 = 0; i2 < res.length; i2++) {\n            if (this.open1.xAxis.data[i] === res[i2].c_hour) {\n              this.open1.series[0].data[i] = res[i2].num\n            }\n          }\n        }\n        this.snowTurnover()\n      })\n    },\n    handleSelectionChange(val) {\n      this.multipleSelection = val\n    },\n    btnClick(data) {\n      this.cur = data\n      this.shua()\n    },\n    clickok() {\n      this.zh = false\n      this.zhdata = []\n    },\n    zhfa(i) {\n      console.log(i)\n      this.zh = true\n      this.zhdata = this.arr[i]\n    },\n    snowTurnover() {\n      var snowTurnover = echarts.init(document.getElementById('snowTurnover'))\n      snowTurnover.resize()\n      snowTurnover.setOption(this.open1)\n    },\n    snowTurnoveraa() {\n      var snowTurnoveraa = echarts.init(\n        document.getElementById('snowTurnoveraa')\n      )\n      get('/alarmInfo/selectCountYesterday', {\n        cpid: this.$store.state.user.companyId\n      }).then(response => {\n        this.open2.series[0].data[1] = response['所有告警']\n        this.open2.series[1].data[1] = response['已确认']\n        this.open2.series[2].data[1] = response['已清除']\n        console.log(111)\n        get('/alarmInfo/selectCountToday', {\n          cpid: this.$store.state.user.companyId\n        }).then(response => {\n          this.open2.series[0].data[0] = response['所有告警']\n          this.open2.series[1].data[0] = response['已确认']\n          this.open2.series[2].data[0] = response['已清除']\n          console.log(110)\n          snowTurnoveraa.resize()\n          snowTurnoveraa.setOption(this.open2)\n        })\n      })\n    },\n    yqr(index) {\n      var that = this\n      var data = []\n      for (var i = 0; i < that.multipleSelection.length; i++) {\n        data.push({ aid: that.multipleSelection[i].id, confirmState: index + '', alarmAffirmTime: '' })\n      }\n      post('/alarmInfo/batchUpdateState', data).then(res => {\n        that.shua()\n      })\n    },\n    qc() {\n      var that = this\n      var data = []\n      for (var i = 0; i < that.multipleSelection.length; i++) {\n        data.push({ aid: that.multipleSelection[i].id, clear_state: i + '', clearTime: '' })\n      }\n      post('/alarmInfo/batchUpdateStateClear', data).then(res => {\n        that.shua()\n      })\n    }\n  }\n}\n",null]}