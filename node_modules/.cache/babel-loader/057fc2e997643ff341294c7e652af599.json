{"remainingRequest":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\babel-loader\\lib\\index.js!D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\办公\\projectwc\\前端\\ManageSys\\src\\views\\map\\mapinstall.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\src\\views\\map\\mapinstall.vue","mtime":1578287501872},{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"D:\\\\\\u529E\\u516C\\\\projectwc\\\\\\u524D\\u7AEF\\\\ManageSys\\\\node_modules\\\\@babel\\\\runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _axios = require(\"@/api/axios\");\n\nvar _shengshi = _interopRequireDefault(require(\"@/assets/shengshi\"));\n\nvar _vueAmap = _interopRequireDefault(require(\"vue-amap\"));\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nvar amapManager = new _vueAmap.default.AMapManager(); // let timer = null\n\nvar _default = {\n  name: 'Map',\n  data: function data() {\n    var _this = this;\n\n    return {\n      name: '电子地图管理',\n      options2: [],\n      imageUrl: '',\n      tape: 1,\n      zoom: 16,\n      amapManager: amapManager,\n      markers: [{\n        position: [116.338535, 39.943609],\n        // [116.338535, 39.943609],\n        icon: '',\n        draggable: false,\n        events: {\n          'click': function click(e) {\n            var lng = e.lnglat.lng;\n            var lat = e.lnglat.lat;\n            var list = [lng, lat]; // this.markers[0].draggable = true\n\n            _this.markers[0].position = list;\n          },\n          dragging: function dragging(e) {\n            _this.input_longitude = e.lnglat.lng;\n            _this.input_latitude = e.lnglat.lat;\n            _this.markers[0].position = [e.lnglat.lng, e.lnglat.lat];\n          }\n        }\n      }],\n      center: [116.336496, 39.942178],\n      events: {\n        'click': function click(e) {\n          var lng = e.lnglat.lng;\n          var lat = e.lnglat.lat;\n          var list = [lng, lat];\n\n          if (_this.add_marker) {\n            _this.input_longitude = lng;\n            _this.input_latitude = lat;\n            _this.markers[0].position = list; // var map = amapManager.getMap()\n            // map.add(this.markers[0])\n            // map.setFitView()\n          } else {\n            _this.$alert('请先点击修改按钮才可执行此操作', '', {\n              confirmButtonText: '确定' // callback: action => {\n              //   this.$message({\n              //     type: 'info',\n              //     message: `action: ${ action }`\n              //   })\n              // }\n\n            });\n          }\n        }\n      },\n      mapStyle1: 'amap://styles/normal',\n      mapStyle2: 'amap://styles/whitesmoke',\n      mapStyle3: 'amap://styles/fresh',\n      lfg: true,\n      id: 0,\n      options: _shengshi.default,\n      value: '',\n      value1: '',\n      input_longitude: '',\n      input_latitude: '',\n      fun: null,\n      save: false,\n      // 可点击\n      edit: true,\n      disabled: true,\n      add_marker: false,\n      // 是否可添加marker\n      save_success: false // 是否成功保存\n\n    };\n  },\n  watch: {\n    value: function value() {\n      console.log(this.value);\n      this.options2 = JSON.parse(this.value).citys;\n\n      if (this.lfg) {\n        this.value1 = '';\n      } else {\n        this.lfg = !this.lfg;\n      }\n    }\n  },\n  created: function created() {},\n  mounted: function mounted() {\n    this.input_longitude = 116.336496;\n    this.input_latitude = 39.942178; // marker.setMap(o)\n\n    this.tapefun(this.tape);\n    this.huo();\n  },\n  methods: {\n    SelectChange: function SelectChange(val) {\n      console.log(val);\n    },\n    Save_btn: function Save_btn() {\n      if (this.value && this.value1 && this.input_longitude && this.input_latitude) {\n        // 可保存\n        this.tapefun(this.tape);\n        this.save_success = true; // 保存成功\n\n        this.save = false;\n        this.edit = true; // 可编辑\n\n        this.disabled = true;\n        this.add_marker = false;\n        this.markers[0].draggable = false;\n      } else {\n        // 不可保存\n        var titles = '';\n\n        if (!this.value) {\n          titles = '省';\n        } else if (!this.value1) {\n          titles = '市';\n        } else if (!this.input_longitude || this.input_latitude) {\n          titles = '经纬度';\n        }\n\n        this.$alert('请检查' + titles + '是否填写', '', {\n          confirmButtonText: '确定' // callback: action => {\n          //   this.$message({\n          //     type: 'info',\n          //     message: `action: ${ action }`\n          //   })\n          // }\n\n        });\n      }\n    },\n    Edit_btn: function Edit_btn() {\n      if (this.edit === true) {\n        // 可编辑状态\n        console.log('可以编辑');\n        this.edit = false;\n        this.save = true;\n        this.add_marker = true; // 可修改marker\n\n        this.disabled = false; // 各选项框可编辑\n\n        this.markers[0].draggable = true;\n      } else {\n        // 不可编辑\n        return false;\n      }\n    },\n    tapefun: function tapefun(data) {\n      this.tape = data;\n      var name = data === 1 ? '高德' : data === 2 ? '百度' : data === 3 ? '腾讯' : '手绘';\n      var data2 = {\n        cpid: this.$store.state.user.companyId,\n        id: this.id,\n        mapName: name,\n        mapType: data,\n        province: this.value.provinceName,\n        city: this.value1,\n        mngMapLon: this.input_longitude,\n        mngMapLat: this.input_latitude\n      };\n      (0, _axios.post)('/mngmapconfig/updMapConfigbyCpid', data2).then(function (res) {\n        console.log(res);\n      });\n    },\n    huo: function huo() {\n      var _this2 = this;\n\n      (0, _axios.get)('/mngmapconfig/getMapConfigbyCpid', {\n        cpid: this.$store.state.user.companyId\n      }).then(function (res) {\n        console.log(res, _this2.options);\n\n        if (res.data.city) {\n          _this2.lfg = false;\n\n          for (var i1 = 0; i1 < _this2.options.length; i1++) {\n            for (var i2 = 0; i2 < _this2.options[i1].citys.length; i2++) {\n              if (res.data.city === _this2.options[i1].citys[i2].citysName) {\n                _this2.value = JSON.stringify(_this2.options[i1]);\n                _this2.value1 = res.data.city;\n              }\n            }\n          }\n        }\n\n        console.log(res);\n        _this2.tape = res.data.mapType;\n        _this2.id = res.data.id;\n        console.log(_this2.value1);\n      });\n    }\n  }\n};\nexports.default = _default;",null]}