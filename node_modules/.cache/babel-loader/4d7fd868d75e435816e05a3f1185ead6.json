{"remainingRequest":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\babel-loader\\lib\\index.js!D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\办公\\projectwc\\前端\\ManageSys\\src\\views\\acquisition\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\src\\views\\acquisition\\index.vue","mtime":1576638137526},{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"D:\\\\\\u529E\\u516C\\\\projectwc\\\\\\u524D\\u7AEF\\\\ManageSys\\\\node_modules\\\\@babel\\\\runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es6.function.name\");\n\nvar _objectSpread2 = _interopRequireDefault(require(\"D:\\\\\\u529E\\u516C\\\\projectwc\\\\\\u524D\\u7AEF\\\\ManageSys\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/objectSpread2\"));\n\nvar _axios = require(\"@/api/axios\");\n\nvar _vuex = require(\"vuex\");\n\nvar _DataWapper = _interopRequireDefault(require(\"./components/DataWapper\"));\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nvar _default = {\n  components: {\n    DataWapper: _DataWapper.default\n  },\n  data: function data() {\n    return {\n      companyData: [],\n      selectCompanyNode: null,\n      defaultProps: {\n        children: 'children',\n        label: 'companyName'\n      },\n      collectionData: [],\n      childSysList: [],\n      childSysText: '',\n      selectCollectionNode: null,\n      showDialog: false,\n      dataForm: {\n        name: '',\n        company: '',\n        childSys: '',\n        childId: 0,\n        server: '',\n        username: '',\n        password: '',\n        protocol: '',\n        coding: '',\n        remark: ''\n      }\n    };\n  },\n  computed: (0, _objectSpread2.default)({}, (0, _vuex.mapGetters)(['companyId'])),\n  created: function created() {\n    this.init();\n  },\n  methods: {\n    init: function init() {\n      var _this = this;\n\n      (0, _axios.get)('/company/' + this.companyId + '/tree', null).then(function (response) {\n        if (response.status === 0) {\n          _this.companyData = response.data;\n          _this.companyData[0].children = [];\n        }\n      });\n      this.initCollection();\n      (0, _axios.get)('/subsystem/list-all', null).then(function (response) {\n        if (response.status === 0) {\n          _this.childSysList = response.data;\n          _this.childSysText = _this.childSysList[0].name;\n        }\n      });\n    },\n    initCollection: function initCollection() {\n      var _this2 = this;\n\n      (0, _axios.get)('/data-collection/list/' + this.companyId, null).then(function (response) {\n        if (response.status === 0) {\n          _this2.collectionData = response.data;\n        }\n      });\n    },\n    companyClick: function companyClick(node, all) {},\n    addCollection: function addCollection(data) {\n      var _this3 = this;\n\n      var form = {\n        cpid: this.companyId,\n        subsystemId: data[0].childId,\n        collectionName: data[0].name,\n        shopName: data[0].company,\n        ip: data[0].server,\n        name: data[0].username,\n        password: data[0].password,\n        protocolType: data[0].protocol,\n        contents: data[0].coding,\n        describes: data[0].remark\n      };\n      (0, _axios.post)('/data-collection', form).then(function (response) {\n        if (response.status === 0) {\n          _this3.$refs.dataDialog.loading = false;\n\n          _this3.$message({\n            message: '数据采集添加成功',\n            type: 'success',\n            duration: 3000\n          });\n        } else {\n          _this3.$message({\n            message: response.msg,\n            type: 'warning',\n            duration: 3000\n          });\n        }\n\n        _this3.initCollection();\n\n        _this3.showDialog = false;\n      });\n    },\n    collectionClick: function collectionClick(node) {\n      this.selectCollectionNode = JSON.parse(JSON.stringify(node));\n      this.$refs.dataPage.collectionForm.id = this.selectCollectionNode.id;\n      this.$refs.dataPage.collectionForm.name = this.selectCollectionNode.collectionName;\n      this.$refs.dataPage.collectionForm.company = this.selectCollectionNode.shopName;\n      this.$refs.dataPage.collectionForm.childSys = this.selectCollectionNode.subSystem.name;\n      this.$refs.dataPage.collectionForm.childId = this.selectCollectionNode.subsystemId;\n      this.$refs.dataPage.collectionForm.server = this.selectCollectionNode.ip;\n      this.$refs.dataPage.collectionForm.username = this.selectCollectionNode.name;\n      this.$refs.dataPage.collectionForm.password = this.selectCollectionNode.password;\n      this.$refs.dataPage.collectionForm.protocol = this.selectCollectionNode.protocolType;\n      this.$refs.dataPage.collectionForm.coding = this.selectCollectionNode.contents;\n      this.$refs.dataPage.collectionForm.remark = this.selectCollectionNode.describes;\n    },\n    deleteCollect: function deleteCollect() {\n      var _this4 = this;\n\n      if (this.selectCollectionNode === null) {\n        this.$message({\n          message: '请选择需要删除的数据采集',\n          type: 'warning',\n          duration: 3000\n        });\n      } else {\n        this.$confirm('是否删除\"' + this.selectCollectionNode.collectionName + '\"', '提示', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(function () {\n          (0, _axios.byDelete)('/data-collection/' + _this4.selectCollectionNode.id, null).then(function (response) {\n            if (response.status === 0) {\n              _this4.$refs.collectionTree.remove(_this4.selectCollectionNode);\n\n              _this4.$refs.dataPage.btnSave = false;\n\n              _this4.$refs.dataPage.$refs.collectionForm.resetFields();\n\n              _this4.selectCollectionNode = null;\n\n              _this4.$message({\n                message: '数据采集删除成功',\n                type: 'success',\n                duration: 3000\n              });\n            } else {\n              _this4.$message({\n                message: response.msg,\n                type: 'warning',\n                duration: 3000\n              });\n            }\n          });\n        });\n      }\n    },\n    updateCollection: function updateCollection(data) {\n      var _this5 = this;\n\n      var form = {\n        id: this.selectCollectionNode.id,\n        subsystemId: data[0].childId,\n        subSystem: {\n          id: data[0].childId,\n          name: data[0].childSys\n        },\n        collectionName: data[0].name,\n        shopName: data[0].company,\n        ip: data[0].server,\n        name: data[0].username,\n        password: data[0].password,\n        protocolType: data[0].protocol,\n        contents: data[0].coding,\n        describes: data[0].remark\n      };\n      (0, _axios.put)('/data-collection', form).then(function (response) {\n        if (response.status === 0) {\n          _this5.$message({\n            message: '修改成功',\n            type: 'success',\n            duration: 3000\n          });\n\n          var len = _this5.collectionData.length;\n\n          for (var i = 0; i < len; i++) {\n            if (_this5.collectionData[i].id === _this5.selectCollectionNode.id) {\n              _this5.collectionData[i].collectionName = form.collectionName;\n              _this5.collectionData[i].shopName = form.shopName;\n              _this5.collectionData[i].subSystem.name = form.subSystem.name;\n              _this5.collectionData[i].subSystem.id = form.subsystemId;\n              _this5.collectionData[i].subsystemId = form.subsystemId;\n              _this5.collectionData[i].ip = form.ip;\n              _this5.collectionData[i].name = form.name;\n              _this5.collectionData[i].password = form.password;\n              _this5.collectionData[i].protocolType = form.protocolType;\n              _this5.collectionData[i].contents = form.contents;\n              _this5.collectionData[i].describes = form.describes;\n            }\n          }\n\n          _this5.$refs.dataPage.loading = false;\n          _this5.$refs.dataPage.btnSave = false;\n        } else {\n          _this5.$message({\n            message: response.msg,\n            type: 'warning',\n            duration: 3000\n          });\n        }\n      });\n    }\n  }\n};\nexports.default = _default;",null]}