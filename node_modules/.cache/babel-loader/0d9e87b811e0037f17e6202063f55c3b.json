{"remainingRequest":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\babel-loader\\lib\\index.js!D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\办公\\projectwc\\前端\\ManageSys\\src\\views\\reservation\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\src\\views\\reservation\\index.vue","mtime":1578302846309},{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"D:\\\\\\u529E\\u516C\\\\projectwc\\\\\\u524D\\u7AEF\\\\ManageSys\\\\node_modules\\\\@babel\\\\runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es6.regexp.to-string\");\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nrequire(\"core-js/modules/es6.regexp.split\");\n\nrequire(\"core-js/modules/es6.function.name\");\n\nvar _echarts = _interopRequireDefault(require(\"echarts\"));\n\nvar _axios = require(\"@/api/axios\");\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n/* eslint-disable */\nvar _default = {\n  /* eslint-disable */\n  name: 'reservation',\n  data: function data() {\n    return {\n      //tab按钮\n      tab: [\"门票\", \"酒店\"],\n      titles: '门票',\n      default_bar: 0,\n      //默认第一个tab \n      nextmonthIncome: '',\n      // 下月金额\n      nextmonthSame: '',\n      // 同比\n      nextmonthDis: '',\n      // 环比\n      nextweekIncome: '',\n      // 下周金额\n      nextweekSame: '',\n      // 同比\n      nextweekDis: '',\n      // 环比\n      data_hotel: null,\n      data_tickets: null,\n      days: [],\n      nowdays: [],\n      data1: [],\n      data2: [],\n      data3: [],\n      data4: [],\n      right1: [],\n      right2: [],\n      right3: [],\n      right4: []\n    };\n  },\n  mounted: function mounted() {\n    // 下个月\n    var day = this.getNowFormatDate();\n    var days = [],\n        nowdays = [],\n        data1 = [],\n        data2 = [],\n        data3 = [],\n        data4 = [];\n\n    for (var i = 1; i <= day; i++) {\n      days.push(i);\n      data1.push(0);\n      data2.push(0);\n      data3.push(0);\n      data4.push(0);\n    }\n\n    this.days = days;\n    this.data1 = data1;\n    this.data2 = data2;\n    this.data3 = data3;\n    this.data4 = data4; // 这个月\n\n    var nowday = this.GetDate();\n    var nowdays = [];\n    var right1 = [],\n        right2 = [],\n        right3 = [],\n        right4 = [];\n\n    for (var i = 1; i <= nowday; i++) {\n      nowdays.push(i);\n      right1.push(0);\n      right2.push(0);\n      right3.push(0);\n      right4.push(0);\n    }\n\n    this.nowdays = nowdays;\n    this.right1 = right1;\n    this.right2 = right2;\n    this.right3 = right3;\n    this.right4 = right4;\n    this.TabClick(0);\n  },\n  // beforeDestroy() {\n  //   window.removeEventListener('resize', this.resizeHandler)\n  // },\n  methods: {\n    TabClick: function TabClick(index) {\n      this.default_bar = index;\n      var that = this;\n\n      if (index === 0) {\n        // 门票\n        this.titles = \"门票\";\n        that.ticks();\n      } else if (index === 1) {\n        // 酒店\n        this.titles = \"酒店\";\n        that.hotes();\n      }\n    },\n    ticks: function ticks() {\n      var _this = this;\n\n      // 门票\n      var that = this;\n      this.$nextTick(function () {\n        (0, _axios.get)('income/findTicketList').then(function (data) {\n          if (data.msg === \"SUCCESS\") {\n            _this.data_tickets = data.data; // 初始化各图数据\n\n            var sourceMap = _this.data_tickets.sourceMap;\n            var legend = [],\n                series_line = [],\n                series1 = [],\n                series2 = [];\n\n            for (var i = 0; i < sourceMap.length; i++) {\n              legend.push(sourceMap[i].sourceName);\n              series1.push({\n                'value': 0,\n                'name': sourceMap[i].sourceName\n              });\n              series2.push({\n                'value': 0,\n                'name': sourceMap[i].sourceName\n              });\n              series_line.push({\n                'name': sourceMap[i].sourceName,\n                'type': 'line',\n                'data': sourceMap[i].sourceName\n              });\n            }\n\n            var data = _this.data_tickets.list; // 右上角环状图\n\n            var top_right_series = series1,\n                top_right_legend = legend; // 左下角折线图\n\n            var left_series = series_line,\n                left_legend = legend,\n                left_datax = that.days;\n            left_legend = legend;\n            var data_sum = [],\n                data_1 = that.data1,\n                data_2 = that.data2,\n                data_3 = that.data3,\n                data_4 = that.data4; // 右下角环状图\n\n            var right_series = series2,\n                right_legend = legend;\n\n            for (var i = 0; i < data.length; i++) {\n              if (data[i]) {\n                if (data[i].dateYear == 8) {\n                  that.nextmonthIncome = data[i].nextmonthIncome ? data[i].nextmonthIncome : 0;\n                  that.nextmonthSame = data[i].nextmonthSame ? data[i].nextmonthSame : 0;\n                  that.nextmonthDis = data[i].nextmonthDis ? data[i].nextmonthDis : 0;\n                  that.nextweekIncome = data[i].nextweekIncome ? data[i].nextweekIncome : 0;\n                  that.nextweekSame = data[i].nextweekSame ? data[i].nextweekSame : 0;\n                  that.nextweekDis = data[i].nextweekDis ? data[i].nextweekDis : 0;\n                } else if (data[i].dateYear == 10) {\n                  // 未来一个月预定金额占比\n                  //top_right_legend.push(data[i].sourceName)\n                  for (var a = 0; a < right_series.length; a++) {\n                    if (right_series[a].name === data[i].sourceName) {\n                      right_series[a].value = data[i].price;\n                    }\n                  }\n                } else if (data[i].dateYear == 9 && data[i].sourceId == 1) {\n                  // left_datax.push(data[i].date.split(' ')[0].split('-')[2])\n                  for (var a = 0; a < that.days.length; a++) {\n                    if (parseInt(data[i].date.split(' ')[0].split('-')[2]) === parseInt(that.days[a])) {\n                      data_1[a] = data[i].price;\n                    }\n                  }\n                } else if (data[i].dateYear == 9 && data[i].sourceId == 2) {\n                  for (var a = 0; a < that.days.length; a++) {\n                    if (parseInt(data[i].date.split(' ')[0].split('-')[2]) === parseInt(that.days[a])) {\n                      data_2[a] = data[i].price;\n                    }\n                  }\n                } else if (data[i].dateYear == 9 && data[i].sourceId == 3) {\n                  for (var a = 0; a < that.days.length; a++) {\n                    if (parseInt(data[i].date.split(' ')[0].split('-')[2]) === parseInt(that.days[a])) {\n                      data_3[a] = data[i].price;\n                    }\n                  }\n                } else if (data[i].dateYear == 9 && data[i].sourceId == 4) {\n                  for (var a = 0; a < that.days.length; a++) {\n                    if (parseInt(data[i].date.split(' ')[0].split('-')[2]) === parseInt(that.days[a])) {\n                      data_4[a] = data[i].price;\n                    }\n                  }\n                } else if (data[i].dateYear == 11) {\n                  // 下周预定金额\n                  for (var a = 0; a < top_right_series.length; a++) {\n                    if (top_right_series[a].name === data[i].sourceName) {\n                      top_right_series[a].value = data[i].price;\n                    }\n                  }\n                }\n              }\n            }\n\n            data_sum = [data_1, data_2, data_3, data_4]; // 左下折线图 datax\n\n            for (var i = 0; i < left_series.length; i++) {\n              left_series[i].data = data_sum[i];\n            }\n\n            that.EchartsRing(top_right_legend, top_right_series, 'echartsbox');\n            that.FutureLine_trend(left_legend, left_series, left_datax, 'futuretend', '金额', {\n              star: '',\n              end: '日门票预定金额:'\n            });\n            that.EchartsRing(right_legend, right_series, 'futuremoney');\n          }\n        });\n      });\n    },\n    hotes: function hotes() {\n      var _this2 = this;\n\n      // 酒店\n      var that = this;\n      this.$nextTick(function () {\n        (0, _axios.get)('income/findHotelList').then(function (data) {\n          if (data.msg === \"SUCCESS\") {\n            that.data_hotel = data.data;\n            var sourceMap = that.data_hotel.hotelMap; // console.log('输出')\n            // console.log(sourceMap)\n            // 初始化各图数据\n\n            var legend = [],\n                series = [],\n                seriesL = [],\n                seriesR = [];\n\n            for (var _a = 0; _a < sourceMap.length; _a++) {\n              legend.push(sourceMap[_a].hotelName);\n              series.push({\n                'value': 0,\n                'name': sourceMap[_a].hotelName\n              });\n              seriesL.push({\n                'name': sourceMap[_a].hotelName,\n                'type': 'line',\n                'data': null\n              });\n              seriesR.push({\n                'name': sourceMap[_a].hotelName,\n                'type': 'line',\n                'data': null\n              });\n            }\n\n            var data = _this2.data_hotel.list; // 下周酒店金额占比-环状图\n\n            var top_right_series = series,\n                top_right_legend = legend; // 未来一个月酒店预订-- 多折线图\n\n            var data_left = [],\n                left_1 = that.data1,\n                left_2 = that.data2,\n                left_3 = that.data3,\n                left_4 = that.data4,\n                // var left_series = leftall,\n            left_legend = legend,\n                left_datax = that.days; // 本月酒店入住-- 多折线图\n\n            var data_right = [],\n                right_1 = that.right1,\n                right_2 = that.right2,\n                right_3 = that.right3,\n                right_4 = that.right4,\n                //var right_series = seriesdata,\n            right_legend = legend,\n                right_datax = that.nowdays;\n\n            for (var i = 0; i < data.length; i++) {\n              if (data[i].dateYear === 8) {\n                that.nextmonthIncome = data[i].nextmonthIncome ? data[i].nextmonthIncome : 0;\n                that.nextmonthSame = data[i].nextmonthSame ? data[i].nextmonthSame : 0;\n                that.nextmonthDis = data[i].nextmonthDis ? data[i].nextmonthDis : 0;\n                that.nextweekIncome = data[i].nextweekIncome ? data[i].nextweekIncome : 0;\n                that.nextweekSame = data[i].nextweekSame ? data[i].nextweekSame : 0;\n                that.nextweekDis = data[i].nextweekDis ? data[i].nextweekDis : 0;\n              } else if (data[i].dateYear === 11) {\n                for (var p = 0; p < top_right_series.length; p++) {\n                  if (top_right_series[p].name == data[i].hotelName) {\n                    top_right_series[p].value = data[i].price;\n                  }\n                } //top_right_series.push({'value':data[i].price, 'name':data[i].hotelName})\n\n              } else if (data[i].dateYear === 9) {\n                //left_datax.push(data[i].date.split(' ')[0].split('-')[2])\n                if (data[i].sourceId === 1) {\n                  for (var a = 0; a < that.days.length; a++) {\n                    if (parseInt(data[i].date.split(' ')[0].split('-')[2]) == parseInt(that.days[a])) {\n                      left_1[a] = data[i].price;\n                    }\n                  }\n                } else if (data[i].sourceId === 2) {\n                  for (var a = 0; a < that.days.length; a++) {\n                    if (parseInt(data[i].date.split(' ')[0].split('-')[2]) == parseInt(that.days[a])) {\n                      left_2[a] = data[i].price;\n                    }\n                  }\n                } else if (data[i].sourceId === 3) {\n                  for (var a = 0; a < that.days.length; a++) {\n                    if (parseInt(data[i].date.split(' ')[0].split('-')[2]) == parseInt(that.days[a])) {\n                      left_3[a] = data[i].price;\n                    }\n                  }\n                } else if (data[i].sourceId === 4) {\n                  for (var a = 0; a < that.days.length; a++) {\n                    if (parseInt(data[i].date.split(' ')[0].split('-')[2]) == parseInt(that.days[a])) {\n                      left_4[a] = data[i].price;\n                    }\n                  }\n                } //left_1.push(data[i].price)\n\n              } else if (data[i].dateYear === 1) {\n                if (data[i].hotelId === 1) {\n                  for (var a = 0; a < that.nowdays.length; a++) {\n                    if (parseInt(data[i].date.split(' ')[0].split('-')[2]) == parseInt(that.days[a])) {\n                      right_1[a] = data[i].price;\n                    }\n                  }\n                } else if (data[i].hotelId === 2) {\n                  for (var a = 0; a < that.nowdays.length; a++) {\n                    if (parseInt(data[i].date.split(' ')[0].split('-')[2]) == parseInt(that.days[a])) {\n                      right_2[a] = data[i].price;\n                    }\n                  }\n                } else if (data[i].hotelId === 3) {\n                  for (var a = 0; a < that.nowdays.length; a++) {\n                    if (parseInt(data[i].date.split(' ')[0].split('-')[2]) == parseInt(that.days[a])) {\n                      right_3[a] = data[i].price;\n                    }\n                  }\n                } else if (data[i].hotelId === 4) {\n                  for (var a = 0; a < that.nowdays.length; a++) {\n                    if (parseInt(data[i].date.split(' ')[0].split('-')[2]) == parseInt(that.days[a])) {\n                      right_4[a] = data[i].price;\n                    }\n                  }\n                } //right_datax.push(data[i].date.split(' ')[0].split('-')[2])\n\n              }\n            } // 左下折线图 datax\n\n\n            data_left = [left_1, left_2, left_3, left_4]; // 右下折线图 datax\n\n            data_right = [right_1, right_2, right_3, right_4];\n            var left_se = seriesL;\n            var right_se = seriesR;\n\n            for (var _i = 0; _i < legend.length; _i++) {\n              left_se[_i].data = data_left[_i];\n              right_se[_i].data = data_right[_i];\n            } // left_se = [\n            //   {'name': '酒店1', 'type':'line', 'data': left_1},\n            //   {'name': '酒店2', 'type':'line', 'data': left_2},\n            //   {'name': '酒店3', 'type':'line', 'data': left_3},\n            //   {'name': '酒店4', 'type':'line', 'data': left_4},\n            // ]\n            // right_se = [\n            //   {'name': '酒店1', 'type':'line', data: right_1},\n            //   {'name': '酒店2', 'type':'line', data: right_2},\n            //   {'name': '酒店3', 'type':'line', data: right_3},\n            //   {'name': '酒店4', 'type':'line', data: right_4},\n            // ]\n\n\n            that.EchartsRing(top_right_legend, top_right_series, 'echartsbox'); //that.FutureLine_trend(left_legend, left_series, left_datax,'futuretend', '金额', {star: '', end:'日酒店预订:'})\n\n            that.FutureLine_trend(left_legend, left_se, left_datax, 'futuretend', '金额', {\n              star: '',\n              end: '日酒店预订:'\n            });\n            that.FutureLine_trend(right_legend, right_se, right_datax, 'futuremoney', '百分比', {\n              star: '',\n              end: '日酒店入住率:'\n            });\n          }\n        });\n      });\n    },\n    EchartsRing: function EchartsRing(legend, series, id) {\n      var that = this;\n\n      var echart1 = _echarts.default.init(document.getElementById(id));\n\n      var option = {\n        title: {\n          show: series.length < 1 && legend.length < 1,\n          textStyle: {\n            color: '#909399',\n            fontWeight: 'normal',\n            fontSize: 14\n          },\n          text: '暂无数据',\n          left: 'center',\n          top: 'center'\n        },\n        tooltip: {\n          trigger: 'item',\n          // formatter: \"{a} <br/>{b}: {c} ({d}%)\"\n          formatter: function formatter(params) {\n            var result = ''; //  result =params.seriesName+''+\"</br>\"\n\n            result += params.seriesName + \"</br>\" + params.marker + \" \" + params.data.name + \" : \" + params.data.value + '(' + params.percent + '%' + ')' + \"</br>\";\n            return result;\n          }\n        },\n        legend: {\n          orient: 'vertical',\n          icon: \"circle\",\n          x: '80%',\n          y: 'center',\n          data: legend\n        },\n        color: ['#89A2FF', '#A2BCFF', '#FF9F9C', '#FFDC79'],\n        //扇形区域以及列表颜色\n        series: [{\n          name: '预订金额占比',\n          type: 'pie',\n          center: ['40%', '55%'],\n          radius: ['30%', '50%'],\n          //minAngle: 5, // 最小的扇区角度（0 ~ 360），用于防止某个值过小导致扇区太小影响交互\n          avoidLabelOverlap: true,\n          // 是否启用防止标签重叠策略\n          hoverAnimation: true,\n          // 是否开启 hover 在扇区上的放大动画效\n          labelLine: {\n            // 设置延长线的长度\n            normal: {\n              show: true,\n              length: 15 // 设置延长线的长度\n              // length2: 10,//设置第二段延长线的长度\n\n            }\n          },\n          label: {\n            normal: {\n              show: true,\n              formatter: function formatter(params) {\n                var result = ''; //  result =params.seriesName+''+\"</br>\"\n\n                result += params.data.value + '(' + params.percent + '%' + ')';\n                return result;\n              }\n            },\n            emphasis: {\n              show: true,\n              textStyle: {// fontSize:'16',\n              }\n            }\n          },\n          data: series\n        }]\n      };\n      echart1.clear();\n      echart1.setOption(option);\n      window.addEventListener('resize', function (e) {\n        if (echart1) {\n          echart1.resize();\n        }\n      });\n    },\n    FutureLine_trend: function FutureLine_trend(lengend, series, datax, id, name, showbox) {\n      var data_color = ['#89A2FF', '#A2BCFF', '#FF9F9C', '#FFDC79']; // 扇形区域以及列表颜色\n\n      var that = this;\n      var option = {\n        title: {\n          show: series.length < 1 && lengend.length < 1,\n          textStyle: {\n            color: '#909399',\n            fontWeight: 'normal',\n            fontSize: 14\n          },\n          text: '暂无数据',\n          left: 'center',\n          top: 'center'\n        },\n        grid: {\n          left: '20',\n          right: '70',\n          bottom: '50'\n        },\n        tooltip: {\n          trigger: 'axis',\n          axisPointer: {\n            type: 'cross'\n          },\n          formatter: function formatter(params) {\n            var result = '';\n            result = showbox.star + params[0].name + showbox.end + \"</br>\";\n            params.forEach(function (item) {\n              result += item.marker + \" \" + item.seriesName + \" : \" + item.value + \"</br>\";\n            });\n            return result;\n          }\n        },\n        legend: {\n          left: 100,\n          top: 30,\n          data: lengend\n        },\n        // 'circle', 'rect', 'roundRect', 'triangle', 'diamond', 'pin', 'arrow', 'none'\n        color: data_color,\n        //扇形区域以及列表颜色\n        xAxis: [{\n          type: 'category',\n          name: '日期(日)',\n          splitLine: {\n            show: false\n          },\n          data: datax,\n          axisPointer: {\n            type: 'line' //轴线是线还是柱形   'line' 直线指示器 'shadow' 阴影指示器'none' 无指示器\n\n          },\n          axisTick: {\n            //是否显示刻度\n            alignWithLabel: true,\n            show: false\n          }\n        }],\n        yAxis: [{\n          type: 'value',\n          name: name,\n          splitLine: {\n            show: false\n          },\n          axisTick: {\n            show: false\n          },\n          axisLabel: {\n            formatter: '{value}'\n          }\n        }],\n        series: series\n      };\n      var that = this;\n\n      var echart2 = _echarts.default.init(document.getElementById(id));\n\n      echart2.clear();\n      option.grid.left = this.getYWidth(Math.max.apply(null, option.series[0].data), Math.max.apply(null, option.series[0].data));\n      echart2.setOption(option);\n      window.addEventListener('resize', function () {\n        if (echart2) {\n          echart2.resize();\n        }\n      });\n    },\n    // 获取下个月多少天\n    getNowFormatDate: function getNowFormatDate() {\n      var date = new Date();\n      var seperator1 = \"-\";\n      var year = date.getFullYear();\n      var month = date.getMonth() + 1;\n      var strDate = date.getDate();\n\n      if (month >= 1 && month <= 9) {\n        month = \"0\" + month;\n      }\n\n      if (strDate >= 0 && strDate <= 9) {\n        strDate = \"0\" + strDate;\n      } //return currentdate;\n\n\n      var currentdate = year + seperator1 + month + seperator1 + strDate;\n      var arr = currentdate.split('-');\n      var year = arr[0]; //获取当前日期的年份\n\n      var month = arr[1]; //获取当前日期的月份\n\n      var day = arr[2]; //获取当前日期的日\n\n      var days = new Date(year, month, 0);\n      days = days.getDate(); //获取当前日期中的月的天数\n\n      var nextDays = days;\n      return nextDays;\n    },\n    //获取当前月的天数\n    GetDate: function GetDate() {\n      var date = new Date();\n      var year = date.getFullYear();\n      var month = date.getMonth() + 1;\n      var d = new Date(year, month, 0);\n      return d.getDate();\n    },\n    getYWidth: function getYWidth(data1, data2) {\n      // 根据数值长度计算显示宽度\n      return ((data1 > data2 ? data1.toString().length : data2.toString().length) * 12).toString();\n    }\n  }\n};\nexports.default = _default;",null]}