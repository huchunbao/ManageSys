{"remainingRequest":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\thread-loader\\dist\\cjs.js!D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\babel-loader\\lib\\index.js!D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\办公\\projectwc\\前端\\ManageSys\\src\\views\\car\\caralarm.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\src\\views\\car\\caralarm.vue","mtime":1576638137173},{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\办公\\projectwc\\前端\\ManageSys\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\nimport { getList, excelList } from '@/api/car';\nimport CarSearch from \"./components/CarSearch\";\nimport CarTable from \"./components/CarTable\";\nimport { parseTime } from '@/utils';\nexport default {\n  name: 'CarAlarm',\n  components: {\n    CarSearch: CarSearch,\n    CarTable: CarTable\n  },\n  data: function data() {\n    return {\n      nameList: [{\n        id: 0,\n        veh_code: '全部车辆'\n      }],\n      datalist: [{\n        id: 1,\n        vehCode: '12345',\n        alarmType: '断电报警',\n        alarmCheck: '已审核',\n        alarmHandle: '已处理',\n        fleet: '一队',\n        terminal: '136218',\n        mobile: '13576458758',\n        alarmTime: '2019-9-6 10:32:12',\n        alarmStatus: '已处理',\n        alarmLocation: '云端动物园',\n        alarmPerson: '王小山',\n        handleTime: '2019-9-6 10:38:27',\n        handleType: '检查',\n        handlePerson: '宁晓博',\n        handleContent: '设备断电',\n        handleResult: '处理完成'\n      }, {\n        id: 2,\n        vehCode: '12346',\n        alarmType: '超速报警',\n        alarmCheck: '已审核',\n        alarmHandle: '已处理',\n        fleet: '一队',\n        terminal: '136219',\n        mobile: '13576458751',\n        alarmTime: '2019-9-7 14:02:52',\n        alarmStatus: '已处理',\n        alarmLocation: '森林冒险公园',\n        alarmPerson: '贺亮',\n        handleTime: '2019-9-7 14:30:27',\n        handleType: '警告',\n        handlePerson: '宁晓博',\n        handleContent: '车辆超速',\n        handleResult: '处理完成'\n      }, {\n        id: 3,\n        vehCode: '12347',\n        alarmType: '超时报警',\n        alarmCheck: '已审核',\n        alarmHandle: '已处理',\n        fleet: '二队',\n        terminal: '136311',\n        mobile: '13576450738',\n        alarmTime: '2019-9-7 11:12:35',\n        alarmStatus: '已处理',\n        alarmLocation: '云端动物园',\n        alarmPerson: '史俊',\n        handleTime: '2019-9-7 11:38:02',\n        handleType: '通知',\n        handlePerson: '韩佳佳',\n        handleContent: '车辆误点',\n        handleResult: '处理完成'\n      }, {\n        id: 4,\n        vehCode: '12348',\n        alarmType: '区域报警',\n        alarmCheck: '已审核',\n        alarmHandle: '已处理',\n        fleet: '二队',\n        terminal: '136312',\n        mobile: '13576450736',\n        alarmTime: '2019-9-8 15:32:12',\n        alarmStatus: '已处理',\n        alarmLocation: '森林冒险公园',\n        alarmPerson: '杨文佳',\n        handleTime: '2019-9-8 15:38:55',\n        handleType: '通知',\n        handlePerson: '韩佳佳',\n        handleContent: '车辆越界',\n        handleResult: '处理完成'\n      }]\n    };\n  },\n  created: function created() {\n    var _this = this;\n\n    this.getTabList('/boatsInfo/cardList', {}).then(function (data) {\n      _this.nameList = _this.nameList.concat(data.data);\n    });\n  },\n  mounted: function mounted() {\n    this.$refs.alarmsearch.queryData = {\n      'startTime': '',\n      'endTime': '',\n      'id': null,\n      'vehCode': '',\n      'pageNum': 1,\n      'pageSize': 20,\n      'alarm': '全部报警'\n    };\n    this.$refs.alarmtable.datalist = this.datalist;\n    this.$refs.alarmtable.total = 4;\n  },\n  methods: {\n    getTabList: function getTabList(url, query) {\n      return new Promise(function (resolve, reject) {\n        getList(url, query).then(function (response) {\n          resolve(response);\n        }).catch(function (error) {\n          reject(error);\n        });\n      });\n    },\n    search: function search(query) {\n      this.searchData(query);\n    },\n    searchData: function searchData(query) {\n      var that = this;\n      var alarmType = query[1].alarm;\n      console.log(alarmType);\n\n      if (alarmType === '断电报警') {\n        that.$refs.alarmtable.datalist = this.datalist.filter(function (item) {\n          return item.id === 1;\n        });\n        that.$refs.alarmtable.total = 1;\n      } else if (alarmType === '超速报警') {\n        that.$refs.alarmtable.datalist = this.datalist.filter(function (item) {\n          return item.id === 2;\n        });\n        that.$refs.alarmtable.total = 1;\n      } else if (alarmType === '超时报警') {\n        that.$refs.alarmtable.datalist = this.datalist.filter(function (item) {\n          return item.id === 3;\n        });\n        that.$refs.alarmtable.total = 1;\n      } else if (alarmType === '区域报警') {\n        that.$refs.alarmtable.datalist = this.datalist.filter(function (item) {\n          return item.id === 4;\n        });\n        that.$refs.alarmtable.total = 1;\n      } else {\n        that.$refs.alarmtable.datalist = this.datalist;\n        that.$refs.alarmtable.total = 4;\n      } // that.getTabList('', query).then(data => {\n      //   that.$refs.alarmtable.datalist = data.data.list.content\n      //   that.$refs.alarmtable.total = data.data.allCount\n      // })\n\n    },\n    excel: function excel(query) {\n      var that = this;\n      new Promise(function (resolve, reject) {\n        excelList('', query[1]).then(function (response) {\n          resolve(response);\n        }).catch(function (error) {\n          reject(error);\n        });\n      }).then(function (response) {\n        var blob = new Blob([response], {\n          type: 'application/vnd.ms-excel'\n        });\n\n        if (window.navigator.msSaveOrOpenBlob) {\n          navigator.msSaveBlob(blob);\n        } else {\n          var link = document.createElement('a');\n          var evt = document.createEvent('HTMLEvents');\n          evt.initEvent('click', false, false);\n          link.href = URL.createObjectURL(blob);\n          link.download = query[1].alarm + parseTime(new Date());\n          link.style.display = 'none';\n          document.body.appendChild(link);\n          link.click();\n          window.URL.revokeObjectURL(link.href);\n        }\n\n        that.$refs.alarmsearch.downloadLoading = false;\n      }).catch(function (e) {\n        console.log(e);\n        that.$refs.alarmsearch.downloadLoading = false;\n      });\n    },\n    pageChange: function pageChange(page) {\n      var query = this.$refs.alarmsearch.queryData;\n      query.pageNum = page[1].page;\n      this.searchData(query);\n    }\n  }\n};",null]}